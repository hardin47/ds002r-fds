<!DOCTYPE html>
<html lang="en"><head>
<link href="../images/favicon.ico" rel="icon">
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-html/tabby.min.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/light-border.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-html.min.css" rel="stylesheet" data-mode="light">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles"><meta charset="utf-8">
  <meta name="generator" content="quarto-1.3.450">

  <meta name="author" content="Jo Hardin">
  <meta name="dcterms.date" content="2024-01-10">
  <title>Data Science, the SQL - SQL joins</title>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
  <link rel="stylesheet" href="../site_libs/revealjs/dist/reset.css">
  <link rel="stylesheet" href="../site_libs/revealjs/dist/reveal.css">
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
      vertical-align: middle;
    }
    /* CSS for syntax highlighting */
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      { color: #003b4f; background-color: #f1f3f5; }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span { color: #003b4f; } /* Normal */
    code span.al { color: #ad0000; } /* Alert */
    code span.an { color: #5e5e5e; } /* Annotation */
    code span.at { color: #657422; } /* Attribute */
    code span.bn { color: #ad0000; } /* BaseN */
    code span.bu { } /* BuiltIn */
    code span.cf { color: #003b4f; } /* ControlFlow */
    code span.ch { color: #20794d; } /* Char */
    code span.cn { color: #8f5902; } /* Constant */
    code span.co { color: #5e5e5e; } /* Comment */
    code span.cv { color: #5e5e5e; font-style: italic; } /* CommentVar */
    code span.do { color: #5e5e5e; font-style: italic; } /* Documentation */
    code span.dt { color: #ad0000; } /* DataType */
    code span.dv { color: #ad0000; } /* DecVal */
    code span.er { color: #ad0000; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #ad0000; } /* Float */
    code span.fu { color: #4758ab; } /* Function */
    code span.im { color: #00769e; } /* Import */
    code span.in { color: #5e5e5e; } /* Information */
    code span.kw { color: #003b4f; } /* Keyword */
    code span.op { color: #5e5e5e; } /* Operator */
    code span.ot { color: #003b4f; } /* Other */
    code span.pp { color: #ad0000; } /* Preprocessor */
    code span.sc { color: #5e5e5e; } /* SpecialChar */
    code span.ss { color: #20794d; } /* SpecialString */
    code span.st { color: #20794d; } /* String */
    code span.va { color: #111111; } /* Variable */
    code span.vs { color: #20794d; } /* VerbatimString */
    code span.wa { color: #5e5e5e; font-style: italic; } /* Warning */
  </style>
  <link rel="stylesheet" href="../site_libs/revealjs/dist/theme/quarto.css">
  <link href="../site_libs/revealjs/plugin/quarto-line-highlight/line-highlight.css" rel="stylesheet">
  <link href="../site_libs/revealjs/plugin/reveal-menu/menu.css" rel="stylesheet">
  <link href="../site_libs/revealjs/plugin/reveal-menu/quarto-menu.css" rel="stylesheet">
  <link href="../site_libs/revealjs/plugin/quarto-support/footer.css" rel="stylesheet">
  <style type="text/css">

  .callout {
    margin-top: 1em;
    margin-bottom: 1em;  
    border-radius: .25rem;
  }

  .callout.callout-style-simple { 
    padding: 0em 0.5em;
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
    display: flex;
  }

  .callout.callout-style-default {
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
  }

  .callout .callout-body-container {
    flex-grow: 1;
  }

  .callout.callout-style-simple .callout-body {
    font-size: 1rem;
    font-weight: 400;
  }

  .callout.callout-style-default .callout-body {
    font-size: 0.9rem;
    font-weight: 400;
  }

  .callout.callout-titled.callout-style-simple .callout-body {
    margin-top: 0.2em;
  }

  .callout:not(.callout-titled) .callout-body {
      display: flex;
  }

  .callout:not(.no-icon).callout-titled.callout-style-simple .callout-content {
    padding-left: 1.6em;
  }

  .callout.callout-titled .callout-header {
    padding-top: 0.2em;
    margin-bottom: -0.2em;
  }

  .callout.callout-titled .callout-title  p {
    margin-top: 0.5em;
    margin-bottom: 0.5em;
  }
    
  .callout.callout-titled.callout-style-simple .callout-content  p {
    margin-top: 0;
  }

  .callout.callout-titled.callout-style-default .callout-content  p {
    margin-top: 0.7em;
  }

  .callout.callout-style-simple div.callout-title {
    border-bottom: none;
    font-size: .9rem;
    font-weight: 600;
    opacity: 75%;
  }

  .callout.callout-style-default  div.callout-title {
    border-bottom: none;
    font-weight: 600;
    opacity: 85%;
    font-size: 0.9rem;
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-default div.callout-content {
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-simple .callout-icon::before {
    height: 1rem;
    width: 1rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 1rem 1rem;
  }

  .callout.callout-style-default .callout-icon::before {
    height: 0.9rem;
    width: 0.9rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 0.9rem 0.9rem;
  }

  .callout-title {
    display: flex
  }
    
  .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  .callout.no-icon::before {
    display: none !important;
  }

  .callout.callout-titled .callout-body > .callout-content > :last-child {
    margin-bottom: 0.5rem;
  }

  .callout.callout-titled .callout-icon::before {
    margin-top: .5rem;
    padding-right: .5rem;
  }

  .callout:not(.callout-titled) .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  /* Callout Types */

  div.callout-note {
    border-left-color: #4582ec !important;
  }

  div.callout-note .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEU0lEQVRYCcVXTWhcVRQ+586kSUMMxkyaElstCto2SIhitS5Ek8xUKV2poatCcVHtUlFQk8mbaaziwpWgglJwVaquitBOfhQXFlqlzSJpFSpIYyXNjBNiTCck7x2/8/LeNDOZxDuEkgOXe++553zfefee+/OYLOXFk3+1LLrRdiO81yNqZ6K9cG0P3MeFaMIQjXssE8Z1JzLO9ls20MBZX7oG8w9GxB0goaPrW5aNMp1yOZIa7Wv6o2ykpLtmAPs/vrG14Z+6d4jpbSKuhdcSyq9wGMPXjonwmESXrriLzFGOdDBLB8Y6MNYBu0dRokSygMA/mrun8MGFN3behm6VVAwg4WR3i6FvYK1T7MHo9BK7ydH+1uurECoouk5MPRyVSBrBHMYwVobG2aOXM07sWrn5qgB60rc6mcwIDJtQrnrEr44kmy+UO9r0u9O5/YbkS9juQckLed3DyW2XV/qWBBB3ptvI8EUY3I9p/67OW+g967TNr3Sotn3IuVlfMLVnsBwH4fsnebJvyGm5GeIUA3jljERmrv49SizPYuq+z7c2H/jlGC+Ghhupn/hcapqmcudB9jwJ/3jvnvu6vu5lVzF1fXyZuZZ7U8nRmVzytvT+H3kilYvH09mLWrQdwFSsFEsxFVs5fK7A0g8gMZjbif4ACpKbjv7gNGaD8bUrlk8x+KRflttr22JEMRUbTUwwDQScyzPgedQHZT0xnx7ujw2jfVfExwYHwOsDTjLdJ2ebmeQIlJ7neo41s/DrsL3kl+W2lWvAga0tR3zueGr6GL78M3ifH0rGXrBC2aAR8uYcIA5gwV8zIE8onoh8u0Fca/ciF7j1uOzEnqcIm59sEXoGc0+z6+H45V1CvAvHcD7THztu669cnp+L0okAeIc6zjbM/24LgGM1gZk7jnRu1aQWoU9sfUOuhrmtaPIO3YY1KLLWZaEO5TKUbMY5zx8W9UJ6elpLwKXbsaZ4EFl7B4bMtDv0iRipKoDQT2sNQI9b1utXFdYisi+wzZ/ri/1m7QfDgEuvgUUEIJPq3DhX/5DWNqIXDOweC2wvIR90Oq3lDpdMIgD2r0dXvGdsEW5H6x6HLRJYU7C69VefO1x8Gde1ZFSJLfWS1jbCnhtOPxmpfv2LXOA2Xk2tvnwKKPFuZ/oRmwBwqRQDcKNeVQkYcOjtWVBuM/JuYw5b6isojIkYxyYAFn5K7ZBF10fea52y8QltAg6jnMqNHFBmGkQ1j+U43HMi2xMar1Nv0zGsf1s8nUsmUtPOOrbFIR8bHFDMB5zL13Gmr/kGlCkUzedTzzmzsaJXhYawnA3UmARpiYj5ooJZiUoxFRtK3X6pgNPv+IZVPcnwbOl6f+aBaO1CNvPW9n9LmCp01nuSaTRF2YxHqZ8DYQT6WsXT+RD6eUztwYLZ8rM+rcPxamv1VQzFUkzFXvkiVrySGQgJNvXHJAxiU3/NwiC03rSf05VBaPtu/Z7/B8Yn/w7eguloAAAAAElFTkSuQmCC');
  }

  div.callout-note.callout-style-default .callout-title {
    background-color: #dae6fb
  }

  div.callout-important {
    border-left-color: #d9534f !important;
  }

  div.callout-important .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEKklEQVRYCcVXTWhcVRS+575MJym48A+hSRFr00ySRQhURRfd2HYjk2SSTokuBCkU2o0LoSKKraKIBTcuFCoidGFD08nkBzdREbpQ1EDNIv8qSGMFUboImMSZd4/f9zJv8ibJMC8xJQfO3HPPPef7zrvvvnvviIkpC9nsw0UttFunbUhpFzFtarSd6WJkStVMw5xyVqYTvkwfzuf/5FgtkVoB0729j1rjXwThS7Vio+Mo6DNnvLfahoZ+i/o32lULuJ3NNiz7q6+pyAUkJaFF6JwaM2lUJlV0MlnQn5aTRbEu0SEqHUa0A4AdiGuB1kFXRfVyg5d87+Dg4DL6m2TLAub60ilj7A1Ec4odSAc8X95sHh7+ZRPCFo6Fnp7HfU/fBng/hi10CjCnWnJjsxvDNxWw0NfV6Rv5GgP3I3jGWXumdTD/3cbEOP2ZbOZp69yniG3FQ9z1jD7bnBu9Fc2tKGC2q+uAJOQHBDRiZX1x36o7fWBs7J9ownbtO+n0/qWkvW7UPIfc37WgT6ZGR++EOJyeQDSb9UB+DZ1G6DdLDzyS+b/kBCYGsYgJbSQHuThGKRcw5xdeQf8YdNHsc6ePXrlSYMBuSIAFTGAtQo+VuALo4BX83N190NWZWbynBjhOHsmNfFWLeL6v+ynsA58zDvvAC8j5PkbOcXCMg2PZFk3q8MjI7WAG/Dp9AwP7jdGBOOQkAvlFUB+irtm16I1Zw9YBcpGTGXYmk3kQIC/Cds55l+iMI3jqhjAuaoe+am2Jw5GT3Nbz3CkE12NavmzN5+erJW7046n/CH1RO/RVa8lBLozXk9uqykkGAyRXLWlLv5jyp4RFsG5vGVzpDLnIjTWgnRy2Rr+tDKvRc7Y8AyZq10jj8DqXdnIRNtFZb+t/ZRtXcDiVnzpqx8mPcDWxgARUqx0W1QB9MeUZiNrV4qP+Ehc+BpNgATsTX8ozYKL2NtFYAHc84fG7ndxUPr+AR/iQSns7uSUufAymwDOb2+NjK27lEFocm/EE2WpyIy/Hi66MWuMKJn8RvxIcj87IM5Vh9663ziW36kR0HNenXuxmfaD8JC7tfKbrhFr7LiZCrMjrzTeGx+PmkosrkNzW94ObzwocJ7A1HokLolY+AvkTiD/q1H0cN48c5EL8Crkttsa/AXQVDmutfyku0E7jShx49XqV3MFK8IryDhYVbj7Sj2P2eBxwcXoe8T8idsKKPRcnZw1b+slFTubwUwhktrfnAt7J++jwQtLZcm3sr9LQrjRzz6cfMv9aLvgmnAGvpoaGLxM4mAEaLV7iAzQ3oU0IvD5x9ix3yF2RAAuYAOO2f7PEFWCXZ4C9Pb2UsgDeVnFSpbFK7/IWu7TPTvBqzbGdCHOJQSxiEjt6IyZmxQyEJHv6xyQsYk//moVFsN2zP6fRImjfq7/n/wFDguUQFNEwugAAAABJRU5ErkJggg==');
  }

  div.callout-important.callout-style-default .callout-title {
    background-color: #f7dddc
  }

  div.callout-warning {
    border-left-color: #f0ad4e !important;
  }

  div.callout-warning .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAETklEQVRYCeVWW2gcVRg+58yaTUnizqbipZeX4uWhBEniBaoUX1Ioze52t7sRq6APio9V9MEaoWlVsFasRq0gltaAPuxms8lu0gcviE/FFOstVbSIxgcv6SU7EZqmdc7v9+9mJtNks51NTUH84ed889/PP+cmxP+d5FIbMJmNbpREu4WUkiTtCicKny0l1pIKmBzovF2S+hIJHX8iEu3hZJ5lNZGqyRrGSIQpq15AzF28jgpeY6yk6GVdrfFqdrD6Iw+QlB8g0YS2g7dyQmXM/IDhBhT0UCiRf59lfqmmDvzRt6kByV/m4JjtzuaujMUM2c5Z2d6JdKrRb3K2q6mA+oYVz8JnDdKPmmNthzkAk/lN63sYPgevrguc72aZX/L9C6x09GYyxBgCX4NlvyGUHOKELlm5rXeR1kchuChJt4SSwyddZRXgvwMGvYo4QSlk3/zkHD8UHxwVJA6zjZZqP8v8kK8OWLnIZtLyCAJagYC4rTGW/9Pqj92N/c+LUaAj27movwbi19tk/whRCIE7Q9vyI6yvRpftAKVTdUjOW40X3h5OXsKCdmFcx0xlLJoSuQngnrJe7Kcjm4OMq9FlC7CMmScQANuNvjfP3PjGXDBaUQmbp296S5L4DrpbrHN1T87ZVEZVCzg1FF0Ft+dKrlLukI+/c9ENo+TvlTDbYFvuKPtQ9+l052rXrgKoWkDAFnvh0wTOmYn8R5f4k/jN/fZiCM1tQx9jQQ4ANhqG4hiL0qIFTGViG9DKB7GYzgubnpofgYRwO+DFjh0Zin2m4b/97EDkXkc+f6xYAPX0KK2I/7fUQuwzuwo/L3AkcjugPNixC8cHf0FyPjWlItmLxWw4Ou9YsQCr5fijMGoD/zpdRy95HRysyXA74MWOnscpO4j2y3HAVisw85hX5+AFBRSHt4ShfLFkIMXTqyKFc46xdzQM6XbAi702a7sy04J0+feReMFKp5q9esYLCqAZYw/k14E/xcLLsFElaornTuJB0svMuJINy8xkIYuL+xPAlWRceH6+HX7THJ0djLUom46zREu7tTkxwmf/FdOZ/sh6Q8qvEAiHpm4PJ4a/doJe0gH1t+aHRgCzOvBvJedEK5OFE5jpm4AGP2a8Dxe3gGJ/pAutug9Gp6he92CsSsWBaEcxGx0FHytmIpuqGkOpldqNYQK8cSoXvd+xLxXADw0kf6UkJNFtdo5MOgaLjiQOQHcn+A6h5NuL2s0qsC2LOM75PcF3yr5STuBSAcGG+meA14K/CI21HcS4LBT6tv0QAh8Dr5l93AhZzG5ZJ4VxAqdZUEl9z7WJ4aN+svMvwHHL21UKTd1mqvChH7/Za5xzXBBKrUcB0TQ+Ulgkfbi/H/YT5EptrGzsEK7tR1B7ln9BBwckYfMiuSqklSznIuoIIOM42MQO+QnduCoFCI0bpkzjCjddHPN/F+2Yu+sd9bKNpVwHhbS3LluK/0zgfwD0xYI5dXuzlQAAAABJRU5ErkJggg==');
  }

  div.callout-warning.callout-style-default .callout-title {
    background-color: #fcefdc
  }

  div.callout-tip {
    border-left-color: #02b875 !important;
  }

  div.callout-tip .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAADr0lEQVRYCe1XTWgTQRj9ZjZV8a9SPIkKgj8I1bMHsUWrqYLVg4Ue6v9BwZOxSYsIerFao7UiUryIqJcqgtpimhbBXoSCVxUFe9CTiogUrUp2Pt+3aUI2u5vdNh4dmMzOzHvvezuz8xNFM0mjnbXaNu1MvFWRXkXEyE6aYOYJpdW4IXuA4r0fo8qqSMDBU0v1HJUgVieAXxzCsdE/YJTdFcVIZQNMyhruOMJKXYFoLfIfIvVIMWdsrd+Rpd86ZmyzzjJmLStqRn0v8lzkb4rVIXvnpScOJuAn2ACC65FkPzEdEy4TPWRLJ2h7z4cArXzzaOdKlbOvKKX25Wl00jSnrwVxAg3o4dRxhO13RBSdNvH0xSARv3adTXbBdTf64IWO2vH0LT+cv4GR1DJt+DUItaQogeBX/chhbTBxEiZ6gftlDNXTrvT7co4ub5A6gp9HIcHvzTa46OS5fBeP87Qm0fQkr4FsYgVQ7Qg+ZayaDg9jhg1GkWj8RG6lkeSacrrHgDaxdoBiZPg+NXV/KifMuB6//JmYH4CntVEHy/keA6x4h4CU5oFy8GzrBS18cLJMXcljAKB6INjWsRcuZBWVaS3GDrqB7rdapVIeA+isQ57Eev9eCqzqOa81CY05VLd6SamW2wA2H3SiTbnbSxmzfp7WtKZkqy4mdyAlGx7ennghYf8voqp9cLSgKdqNfa6RdRsAAkPwRuJZNbpByn+RrJi1RXTwdi8RQF6ymDwGMAtZ6TVE+4uoKh+MYkcLsT0Hk8eAienbiGdjJHZTpmNjlbFJNKDVAp2fJlYju6IreQxQ08UJDNYdoLSl6AadO+fFuCQqVMB1NJwPm69T04Wv5WhfcWyfXQB+wXRs1pt+nCknRa0LVzSA/2B+a9+zQJadb7IyyV24YAxKp2Jqs3emZTuNnKxsah+uabKbMk7CbTgJx/zIgQYErIeTKRQ9yD9wxVof5YolPHqaWo7TD6tJlh7jQnK5z2n3+fGdggIOx2kaa2YI9QWarc5Ce1ipNWMKeSG4DysFF52KBmTNMmn5HqCFkwy34rDg05gDwgH3bBi+sgFhN/e8QvRn8kbamCOhgrZ9GJhFDgfcMHzFb6BAtjKpFhzTjwv1KCVuxHvCbsSiEz4CANnj84cwHdFXAbAOJ4LTSAawGWFn5tDhLMYz6nWeU2wJfIhmIJBefcd/A5FWQWGgrWzyORZ3Q6HuV+Jf0Bj+BTX69fm1zWgK7By1YTXchFDORywnfQ7GpzOo6S+qECrsx2ifVQAAAABJRU5ErkJggg==');
  }

  div.callout-tip.callout-style-default .callout-title {
    background-color: #ccf1e3
  }

  div.callout-caution {
    border-left-color: #fd7e14 !important;
  }

  div.callout-caution .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAACV0lEQVRYCdVWzWoUQRCuqp2ICBLJXgITZL1EfQDBW/bkzUMUD7klD+ATSHBEfAIfQO+iXsWDxJsHL96EHAwhgzlkg8nBg25XWb0zIb0zs9muYYWkoKeru+vn664fBqElyZNuyh167NXJ8Ut8McjbmEraKHkd7uAnAFku+VWdb3reSmRV8PKSLfZ0Gjn3a6Xlcq9YGb6tADjn+lUfTXtVmaZ1KwBIvFI11rRXlWlatwIAAv2asaa9mlB9wwygiDX26qaw1yYPzFXg2N1GgG0FMF8Oj+VIx7E/03lHx8UhvYyNZLN7BwSPgekXXLribw7w5/c8EF+DBK5idvDVYtEEwMeYefjjLAdEyQ3M9nfOkgnPTEkYU+sxMq0BxNR6jExrAI31H1rzvLEfRIdgcv1XEdj6QTQAS2wtstEALLG1yEZ3QhH6oDX7ExBSFEkFINXH98NTrme5IOaaA7kIfiu2L8A3qhH9zRbukdCqdsA98TdElyeMe5BI8Rs2xHRIsoTSSVFfCFCWGPn9XHb4cdobRIWABNf0add9jakDjQJpJ1bTXOJXnnRXHRf+dNL1ZV1MBRCXhMbaHqGI1JkKIL7+i8uffuP6wVQAzO7+qVEbF6NbS0LJureYcWXUUhH66nLR5rYmva+2tjRFtojkM2aD76HEGAD3tPtKM309FJg5j/K682ywcWJ3PASCcycH/22u+Bh7Aa0ehM2Fu4z0SAE81HF9RkB21c5bEn4Dzw+/qNOyXr3DCTQDMBOdhi4nAgiFDGCinIa2owCEChUwD8qzd03PG+qdW/4fDzjUMcE1ZpIAAAAASUVORK5CYII=');
  }

  div.callout-caution.callout-style-default .callout-title {
    background-color: #ffe5d0
  }

  </style>
  <style type="text/css">
    .reveal div.sourceCode {
      margin: 0;
      overflow: auto;
    }
    .reveal div.hanging-indent {
      margin-left: 1em;
      text-indent: -1em;
    }
    .reveal .slide:not(.center) {
      height: 100%;
    }
    .reveal .slide.scrollable {
      overflow-y: auto;
    }
    .reveal .footnotes {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide .absolute {
      position: absolute;
      display: block;
    }
    .reveal .footnotes ol {
      counter-reset: ol;
      list-style-type: none; 
      margin-left: 0;
    }
    .reveal .footnotes ol li:before {
      counter-increment: ol;
      content: counter(ol) ". "; 
    }
    .reveal .footnotes ol li > p:first-child {
      display: inline-block;
    }
    .reveal .slide ul,
    .reveal .slide ol {
      margin-bottom: 0.5em;
    }
    .reveal .slide ul li,
    .reveal .slide ol li {
      margin-top: 0.4em;
      margin-bottom: 0.2em;
    }
    .reveal .slide ul[role="tablist"] li {
      margin-bottom: 0;
    }
    .reveal .slide ul li > *:first-child,
    .reveal .slide ol li > *:first-child {
      margin-block-start: 0;
    }
    .reveal .slide ul li > *:last-child,
    .reveal .slide ol li > *:last-child {
      margin-block-end: 0;
    }
    .reveal .slide .columns:nth-child(3) {
      margin-block-start: 0.8em;
    }
    .reveal blockquote {
      box-shadow: none;
    }
    .reveal .tippy-content>* {
      margin-top: 0.2em;
      margin-bottom: 0.7em;
    }
    .reveal .tippy-content>*:last-child {
      margin-bottom: 0.2em;
    }
    .reveal .slide > img.stretch.quarto-figure-center,
    .reveal .slide > img.r-stretch.quarto-figure-center {
      display: block;
      margin-left: auto;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-left,
    .reveal .slide > img.r-stretch.quarto-figure-left  {
      display: block;
      margin-left: 0;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-right,
    .reveal .slide > img.r-stretch.quarto-figure-right  {
      display: block;
      margin-left: auto;
      margin-right: 0; 
    }
  </style>
  <link href="../site_libs/font-awesome-6.4.2/css/all.min.css" rel="stylesheet">
  <link href="../site_libs/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet">
</head>
<body class="quarto-light">
  <div class="reveal">
    <div class="slides">

<section id="title-slide" class="quarto-title-block center">
  <h1 class="title">SQL joins</h1>

<div class="quarto-title-authors">
<div class="quarto-title-author">
<div class="quarto-title-author-name">
Jo Hardin 
</div>
</div>
</div>

  <p class="date">2024-01-10</p>
</section>
<section>
<section id="todays-example" class="title-slide slide level1 center">
<h1>Today’s example</h1>

</section>
<section id="imdb" class="slide level2">
<h2>IMDb</h2>
<p>Consider a database of information from <a href="https://www.imdb.com/" target="_blank">IMDb</a>.</p>

<img data-src="../images/ted-lasso.jpg" style="width:90.0%" class="r-stretch quarto-figure-center"></section>
<section id="imdb-1" class="slide level2 scrollable">
<h2>IMDb</h2>
<p>21 tables in the <code>imdb</code> database! Lots of details on movies, TV series, video games, and more. Today interest is in movies (and details within, like actors and ratings).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource sql number-lines code-with-copy"><code class="sourceCode sql"><span id="cb1-1"><a href="#cb1-1"></a>SHOW <span class="kw">TABLES</span>;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="knitsql-table">

<table>
<caption>
Displaying records 1 - 10
</caption>
<thead>
<tr>
<th style="text-align:left;">
Tables_in_imdb
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
aka_name
</td>
</tr>
<tr>
<td style="text-align:left;">
aka_title
</td>
</tr>
<tr>
<td style="text-align:left;">
cast_info
</td>
</tr>
<tr>
<td style="text-align:left;">
char_name
</td>
</tr>
<tr>
<td style="text-align:left;">
comp_cast_type
</td>
</tr>
<tr>
<td style="text-align:left;">
company_name
</td>
</tr>
<tr>
<td style="text-align:left;">
company_type
</td>
</tr>
<tr>
<td style="text-align:left;">
complete_cast
</td>
</tr>
<tr>
<td style="text-align:left;">
info_type
</td>
</tr>
<tr>
<td style="text-align:left;">
keyword
</td>
</tr>
</tbody>

</table>
</div>
</div>
</section>
<section id="imdb---glance-through-tables" class="slide level2 scrollable">
<h2>IMDb - glance through tables</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode numberSource sql number-lines code-with-copy"><code class="sourceCode sql"><span id="cb2-1"><a href="#cb2-1"></a><span class="kw">SELECT</span> <span class="op">*</span> <span class="kw">FROM</span> kind_type</span>
<span id="cb2-2"><a href="#cb2-2"></a><span class="kw">LIMIT</span> <span class="dv">0</span>, <span class="dv">10</span>;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="knitsql-table">

<table>
<caption>
7 records
</caption>
<thead>
<tr>
<th style="text-align:left;">
id
</th>
<th style="text-align:left;">
kind
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
movie
</td>
</tr>
<tr>
<td style="text-align:left;">
2
</td>
<td style="text-align:left;">
tv series
</td>
</tr>
<tr>
<td style="text-align:left;">
3
</td>
<td style="text-align:left;">
tv movie
</td>
</tr>
<tr>
<td style="text-align:left;">
4
</td>
<td style="text-align:left;">
video movie
</td>
</tr>
<tr>
<td style="text-align:left;">
5
</td>
<td style="text-align:left;">
tv mini series
</td>
</tr>
<tr>
<td style="text-align:left;">
6
</td>
<td style="text-align:left;">
video game
</td>
</tr>
<tr>
<td style="text-align:left;">
7
</td>
<td style="text-align:left;">
episode
</td>
</tr>
</tbody>

</table>
</div>
</div>
</section>
<section id="all-the-joins" class="slide level2">
<h2>All the <code>JOIN</code>s</h2>
<ul>
<li><code>JOIN</code> (aka <code>INNER JOIN</code>): include all of the rows that exist in both tables</li>
<li><code>LEFT JOIN</code>: include all of the rows in the first table.<br>
</li>
<li><code>RIGHT JOIN</code>: include all of the rows in the second table.</li>
<li><code>FULL OUTER JOIN</code>: include all rows in either table. (The functionality doesn’t exist in <strong>MySQL</strong> but can be created using joins and <code>UNION</code>.)</li>
<li><code>CROSS JOIN</code>: match each row of the first table with each row in the second table.</li>
</ul>
</section>
<section id="all-the-joins-1" class="slide level2">
<h2>All the <code>JOIN</code>s</h2>
<p>Venn diagrams of the different types of joins.</p>

<img data-src="../images/join-types.png" style="width:70.0%" alt="Venn diagrams describing different types of JOINs." class="r-stretch quarto-figure-center"><p class="caption">Figure&nbsp;1: Venn diagrams describing different JOINs, image credit: phoenixNAP https://phoenixnap.com/kb/mysql-join</p></section>
<section id="all-the-joins-2" class="slide level2">
<h2>All the <code>JOIN</code>s</h2>
<p>Mini data tables of the different types of <code>JOIN</code>. (In <strong>SQL</strong> the missing values will be labeled as <code>NULL</code> (not <code>NA</code>).)</p>

<img data-src="../images/table-joins.png" style="width:70.0%" alt="Mini data tables describing different types of JOINs." class="r-stretch quarto-figure-center"><p class="caption">Figure&nbsp;2: Mini data tables describing different JOINs, image credit: Statistics Globe blog, https://statisticsglobe.com/r-dplyr-join-inner-left-right-full-semi-anti</p></section>
<section id="all-the-joins-3" class="slide level2">
<h2>All the <code>JOIN</code>s</h2>
<p>Each <code>JOIN</code> clause needs four specific pieces of information:</p>
<ol type="1">
<li>The name of the first table you want to <code>JOIN</code>.</li>
<li>The type of <code>JOIN</code> being used.</li>
<li>The name of the second table you want to <code>JOIN</code>.</li>
<li>The condition(s) under which you want the records in the first table to match records in the second table.</li>
</ol>
</section>
<section id="a-toy-example" class="slide level2 scrollable">
<h2>A toy example</h2>
<p>Rock bands from the 60s.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1"></a>band_members</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 2
  name  band   
  &lt;chr&gt; &lt;chr&gt;  
1 Mick  Stones 
2 John  Beatles
3 Paul  Beatles</code></pre>
</div>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1"></a>band_instruments</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 2
  name  plays 
  &lt;chr&gt; &lt;chr&gt; 
1 John  guitar
2 Paul  bass  
3 Keith guitar</code></pre>
</div>
</div>
<p>The function <code>sqldf()</code> in the <strong>sqldf</strong> <strong>R</strong> package allows for <strong>SQL</strong> commands on <strong>R</strong> objects.</p>
</section>
<section id="rock-bands---inner-join" class="slide level2 scrollable">
<h2>Rock bands - <code>INNER JOIN</code></h2>
<p>An inner join combines two datasets returning only the observations that exist in both of the original datasets.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1"></a>sqldf<span class="sc">::</span><span class="fu">sqldf</span>(<span class="st">"SELECT star.name,</span></span>
<span id="cb7-2"><a href="#cb7-2"></a><span class="st">                     star.band,</span></span>
<span id="cb7-3"><a href="#cb7-3"></a><span class="st">                     inst.plays</span></span>
<span id="cb7-4"><a href="#cb7-4"></a><span class="st">              FROM band_members AS star</span></span>
<span id="cb7-5"><a href="#cb7-5"></a><span class="st">              JOIN band_instruments AS inst ON star.name = inst.name"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  name    band  plays
1 John Beatles guitar
2 Paul Beatles   bass</code></pre>
</div>
</div>
</section>
<section id="rock-bands---full-join" class="slide level2 scrollable">
<h2>Rock bands - <code>FULL JOIN</code></h2>
<p>A full join combines two datasets returning every observation that exists in either one of the original datasets.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1"></a>band_members <span class="sc">|&gt;</span></span>
<span id="cb9-2"><a href="#cb9-2"></a>  <span class="fu">full_join</span>(band_instruments)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 4 × 3
  name  band    plays 
  &lt;chr&gt; &lt;chr&gt;   &lt;chr&gt; 
1 Mick  Stones  &lt;NA&gt;  
2 John  Beatles guitar
3 Paul  Beatles bass  
4 Keith &lt;NA&gt;    guitar</code></pre>
</div>
</div>
<p>The <code>full_join()</code> function does not have an equivalent in <strong>MySQL</strong>. See notes for using <code>JOIN</code>s and <code>UNION</code>s to produce a full join.</p>
</section>
<section id="rock-bands---left-join" class="slide level2 scrollable">
<h2>Rock bands - <code>LEFT JOIN</code></h2>
<p>A left join combines two datasets returning every observation that exists in the left (or first) original dataset.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1"></a>sqldf<span class="sc">::</span><span class="fu">sqldf</span>(<span class="st">"SELECT star.name,</span></span>
<span id="cb11-2"><a href="#cb11-2"></a><span class="st">                     star.band,</span></span>
<span id="cb11-3"><a href="#cb11-3"></a><span class="st">                      inst.plays</span></span>
<span id="cb11-4"><a href="#cb11-4"></a><span class="st">              FROM band_members AS star</span></span>
<span id="cb11-5"><a href="#cb11-5"></a><span class="st">              LEFT JOIN band_instruments AS inst </span></span>
<span id="cb11-6"><a href="#cb11-6"></a><span class="st">              ON star.name = inst.name"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  name    band  plays
1 Mick  Stones   &lt;NA&gt;
2 John Beatles guitar
3 Paul Beatles   bass</code></pre>
</div>
</div>
</section>
<section id="rock-bands---right-join" class="slide level2 scrollable">
<h2>Rock bands - <code>RIGHT JOIN</code></h2>
<p>A right join combines two datasets returning every observation that exists in the right (or second) original dataset.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1"></a>sqldf<span class="sc">::</span><span class="fu">sqldf</span>(<span class="st">"SELECT inst.name,</span></span>
<span id="cb13-2"><a href="#cb13-2"></a><span class="st">                     star.band,</span></span>
<span id="cb13-3"><a href="#cb13-3"></a><span class="st">                      inst.plays</span></span>
<span id="cb13-4"><a href="#cb13-4"></a><span class="st">              FROM band_members AS star</span></span>
<span id="cb13-5"><a href="#cb13-5"></a><span class="st">              RIGHT JOIN band_instruments AS inst </span></span>
<span id="cb13-6"><a href="#cb13-6"></a><span class="st">              ON star.name = inst.name"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   name    band  plays
1  John Beatles guitar
2  Paul Beatles   bass
3 Keith    &lt;NA&gt; guitar</code></pre>
</div>
</div>
</section>
<section id="rock-bands---cross-join" class="slide level2 scrollable">
<h2>Rock bands - <code>CROSS JOIN</code></h2>
<p>A right join combines two datasets returning every observation that exists in the right (or second) original dataset.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1"></a>sqldf<span class="sc">::</span><span class="fu">sqldf</span>(<span class="st">"SELECT *</span></span>
<span id="cb15-2"><a href="#cb15-2"></a><span class="st">              FROM band_members AS star</span></span>
<span id="cb15-3"><a href="#cb15-3"></a><span class="st">              CROSS JOIN band_instruments AS inst"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  name    band  name  plays
1 Mick  Stones  John guitar
2 Mick  Stones  Paul   bass
3 Mick  Stones Keith guitar
4 John Beatles  John guitar
5 John Beatles  Paul   bass
6 John Beatles Keith guitar
7 Paul Beatles  John guitar
8 Paul Beatles  Paul   bass
9 Paul Beatles Keith guitar</code></pre>
</div>
</div>
</section>
<section id="join-imdb-title-votes" class="slide level2 scrollable">
<h2><code>JOIN</code> IMDb title + votes</h2>
<p>In the <code>imdb</code> database, the <code>title</code> table includes information about the 4,626,322 titles in the database, including the <code>id</code>, <code>title</code>, <code>kind_id</code> (indicator for the kind of ID it is), and <code>production_year</code>. It does not, however, include the review of the title.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode numberSource sql number-lines code-with-copy"><code class="sourceCode sql"><span id="cb17-1"><a href="#cb17-1"></a><span class="kw">SELECT</span> <span class="op">*</span> <span class="kw">FROM</span> title <span class="kw">LIMIT</span> <span class="dv">0</span>, <span class="dv">10</span>;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="knitsql-table">

<table>
<caption>
Displaying records 1 - 10
</caption>
<thead>
<tr>
<th style="text-align:right;">
id
</th>
<th style="text-align:left;">
title
</th>
<th style="text-align:left;">
imdb_index
</th>
<th style="text-align:right;">
kind_id
</th>
<th style="text-align:right;">
production_year
</th>
<th style="text-align:right;">
imdb_id
</th>
<th style="text-align:left;">
phonetic_code
</th>
<th style="text-align:right;">
episode_of_id
</th>
<th style="text-align:right;">
season_nr
</th>
<th style="text-align:right;">
episode_nr
</th>
<th style="text-align:left;">
series_years
</th>
<th style="text-align:left;">
md5sum
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
78460
</td>
<td style="text-align:left;">
Adults Recat to the Simpsons (30th Anniversary)
</td>
<td style="text-align:left;">
</td>
<td style="text-align:right;">
7
</td>
<td style="text-align:right;">
2017
</td>
<td style="text-align:right;">
</td>
<td style="text-align:left;">
A3432
</td>
<td style="text-align:right;">
78406
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
2ae09eed7d576cc2c24774fed5b18168
</td>
</tr>
<tr>
<td style="text-align:right;">
70273
</td>
<td style="text-align:left;">
(2016-05-18)
</td>
<td style="text-align:left;">
</td>
<td style="text-align:right;">
7
</td>
<td style="text-align:right;">
2016
</td>
<td style="text-align:right;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:right;">
68058
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
511dfc14cfff7589d29a95abb30cd66a
</td>
</tr>
<tr>
<td style="text-align:right;">
60105
</td>
<td style="text-align:left;">
(2014-04-11)
</td>
<td style="text-align:left;">
</td>
<td style="text-align:right;">
7
</td>
<td style="text-align:right;">
2014
</td>
<td style="text-align:right;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:right;">
59138
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
c6cdce7e667e07713e431805c407feed
</td>
</tr>
<tr>
<td style="text-align:right;">
32120
</td>
<td style="text-align:left;">
(2008-05-01)
</td>
<td style="text-align:left;">
</td>
<td style="text-align:right;">
7
</td>
<td style="text-align:right;">
2008
</td>
<td style="text-align:right;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:right;">
32060
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
100df65742caf5afd092b2e0ead67d8e
</td>
</tr>
<tr>
<td style="text-align:right;">
97554
</td>
<td style="text-align:left;">
SchmÃ¶lders Traum
</td>
<td style="text-align:left;">
</td>
<td style="text-align:right;">
7
</td>
<td style="text-align:right;">
2001
</td>
<td style="text-align:right;">
</td>
<td style="text-align:left;">
S2543
</td>
<td style="text-align:right;">
97302
</td>
<td style="text-align:right;">
10
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
46862a2f96f9fb2d59e8c9a11ecfdd28
</td>
</tr>
<tr>
<td style="text-align:right;">
57966
</td>
<td style="text-align:left;">
(#1.1)
</td>
<td style="text-align:left;">
</td>
<td style="text-align:right;">
7
</td>
<td style="text-align:right;">
2013
</td>
<td style="text-align:right;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:right;">
57965
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
409c37703766c4b24f8a86162fd9cf85
</td>
</tr>
<tr>
<td style="text-align:right;">
76391
</td>
<td style="text-align:left;">
Anniversary
</td>
<td style="text-align:left;">
</td>
<td style="text-align:right;">
7
</td>
<td style="text-align:right;">
1971
</td>
<td style="text-align:right;">
</td>
<td style="text-align:left;">
A5162
</td>
<td style="text-align:right;">
76385
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
9
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
5e12ce73fac1d1dcf94136b6e9acd8f8
</td>
</tr>
<tr>
<td style="text-align:right;">
11952
</td>
<td style="text-align:left;">
Angus Black/Lester Barrie/DC Curry
</td>
<td style="text-align:left;">
</td>
<td style="text-align:right;">
7
</td>
<td style="text-align:right;">
2009
</td>
<td style="text-align:right;">
</td>
<td style="text-align:left;">
A5214
</td>
<td style="text-align:right;">
11937
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
7
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
9c38b9e5601dc154444b73b518034aa1
</td>
</tr>
<tr>
<td style="text-align:right;">
1554
</td>
<td style="text-align:left;">
New Orleans
</td>
<td style="text-align:left;">
</td>
<td style="text-align:right;">
7
</td>
<td style="text-align:right;">
2003
</td>
<td style="text-align:right;">
</td>
<td style="text-align:left;">
N6452
</td>
<td style="text-align:right;">
1508
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
11
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
621bea735740a547e862e4a3226f35d2
</td>
</tr>
<tr>
<td style="text-align:right;">
58442
</td>
<td style="text-align:left;">
Kiss Me Kate
</td>
<td style="text-align:left;">
</td>
<td style="text-align:right;">
7
</td>
<td style="text-align:right;">
2011
</td>
<td style="text-align:right;">
</td>
<td style="text-align:left;">
K2523
</td>
<td style="text-align:right;">
58436
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
10
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
293e8c75c7f35a4035abf617962be5a9
</td>
</tr>
</tbody>

</table>
</div>
</div>
</section>
<section id="join-imdb-title-votes-1" class="slide level2 scrollable">
<h2><code>JOIN</code> IMDb title + votes</h2>
<p>The <code>movie_info_idx</code> table does not contain much information about each particular film. It does, however, have an indicator for the movie ID (given by <code>movie_id</code>) as well as the number of votes (given by <code>info</code> where <code>type_id = 100</code>).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode numberSource sql number-lines code-with-copy"><code class="sourceCode sql"><span id="cb18-1"><a href="#cb18-1"></a><span class="kw">SELECT</span> <span class="op">*</span> <span class="kw">FROM</span> movie_info_idx <span class="kw">LIMIT</span> <span class="dv">0</span>, <span class="dv">6</span>;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="knitsql-table">

<table>
<caption>
6 records
</caption>
<thead>
<tr>
<th style="text-align:left;">
id
</th>
<th style="text-align:right;">
movie_id
</th>
<th style="text-align:right;">
info_type_id
</th>
<th style="text-align:left;">
info
</th>
<th style="text-align:left;">
note
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
99
</td>
<td style="text-align:left;">
31.2.1..2.
</td>
<td style="text-align:left;">
</td>
</tr>
<tr>
<td style="text-align:left;">
2
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
100
</td>
<td style="text-align:left;">
9
</td>
<td style="text-align:left;">
</td>
</tr>
<tr>
<td style="text-align:left;">
3
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
101
</td>
<td style="text-align:left;">
4.1
</td>
<td style="text-align:left;">
</td>
</tr>
<tr>
<td style="text-align:left;">
4
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
99
</td>
<td style="text-align:left;">
1000000102
</td>
<td style="text-align:left;">
</td>
</tr>
<tr>
<td style="text-align:left;">
5
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
100
</td>
<td style="text-align:left;">
61
</td>
<td style="text-align:left;">
</td>
</tr>
<tr>
<td style="text-align:left;">
6
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
101
</td>
<td style="text-align:left;">
6.4
</td>
<td style="text-align:left;">
</td>
</tr>
</tbody>

</table>
</div>
</div>
</section>
<section id="join-imdb-title-votes-2" class="slide level2 scrollable">
<h2><code>JOIN</code> IMDb title + votes</h2>
<ul>
<li>combine the titles with the number of votes so that each title with user votes is included (<code>INNER JOIN</code>)</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode numberSource sql number-lines code-with-copy"><code class="sourceCode sql"><span id="cb19-1"><a href="#cb19-1"></a><span class="kw">SELECT</span> title.<span class="kw">id</span>,</span>
<span id="cb19-2"><a href="#cb19-2"></a>       title.title,</span>
<span id="cb19-3"><a href="#cb19-3"></a>       movie_info_idx.info</span>
<span id="cb19-4"><a href="#cb19-4"></a><span class="kw">FROM</span> title</span>
<span id="cb19-5"><a href="#cb19-5"></a><span class="kw">JOIN</span> movie_info_idx <span class="kw">ON</span> title.<span class="kw">id</span> <span class="op">=</span> movie_info_idx.movie_id </span>
<span id="cb19-6"><a href="#cb19-6"></a><span class="kw">WHERE</span> title.production_year <span class="op">=</span> <span class="dv">2015</span> </span>
<span id="cb19-7"><a href="#cb19-7"></a>    <span class="kw">AND</span> title.kind_id <span class="op">=</span> <span class="dv">1</span>                  # movies <span class="kw">only</span></span>
<span id="cb19-8"><a href="#cb19-8"></a>    <span class="kw">AND</span> movie_info_idx.info_type_id <span class="op">=</span> <span class="dv">100</span>  # info_type <span class="kw">is</span> votes</span>
<span id="cb19-9"><a href="#cb19-9"></a>    <span class="kw">AND</span> movie_info_idx.info <span class="op">&gt;</span> <span class="dv">150000</span>       # <span class="kw">at</span> <span class="fu">least</span> <span class="dv">150</span>,<span class="dv">000</span> votes</span>
<span id="cb19-10"><a href="#cb19-10"></a><span class="kw">ORDER</span> <span class="kw">BY</span> movie_info_idx.info <span class="kw">DESC</span></span>
<span id="cb19-11"><a href="#cb19-11"></a><span class="kw">LIMIT</span> <span class="dv">0</span>, <span class="dv">20</span>;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="knitsql-table">

<table>
<caption>
Displaying records 1 - 10
</caption>
<thead>
<tr>
<th style="text-align:right;">
id
</th>
<th style="text-align:left;">
title
</th>
<th style="text-align:left;">
info
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
4260166
</td>
<td style="text-align:left;">
Star Wars: Episode VII - The Force Awakens
</td>
<td style="text-align:left;">
691691
</td>
</tr>
<tr>
<td style="text-align:right;">
3915213
</td>
<td style="text-align:left;">
Mad Max: Fury Road
</td>
<td style="text-align:left;">
666484
</td>
</tr>
<tr>
<td style="text-align:right;">
4389619
</td>
<td style="text-align:left;">
The Martian
</td>
<td style="text-align:left;">
583987
</td>
</tr>
<tr>
<td style="text-align:right;">
3313672
</td>
<td style="text-align:left;">
Avengers: Age of Ultron
</td>
<td style="text-align:left;">
540606
</td>
</tr>
<tr>
<td style="text-align:right;">
4414139
</td>
<td style="text-align:left;">
The Revenant
</td>
<td style="text-align:left;">
526189
</td>
</tr>
<tr>
<td style="text-align:right;">
3787790
</td>
<td style="text-align:left;">
Jurassic World
</td>
<td style="text-align:left;">
471237
</td>
</tr>
<tr>
<td style="text-align:right;">
3752999
</td>
<td style="text-align:left;">
Inside Out
</td>
<td style="text-align:left;">
443051
</td>
</tr>
<tr>
<td style="text-align:right;">
3292159
</td>
<td style="text-align:left;">
Ant-Man
</td>
<td style="text-align:left;">
390965
</td>
</tr>
<tr>
<td style="text-align:right;">
4364483
</td>
<td style="text-align:left;">
The Hateful Eight
</td>
<td style="text-align:left;">
363199
</td>
</tr>
<tr>
<td style="text-align:right;">
4251736
</td>
<td style="text-align:left;">
Spectre
</td>
<td style="text-align:left;">
319875
</td>
</tr>
</tbody>

</table>
</div>
</div>
<p>Some aspects of the query are worth pointing out:<br>
* The variables in the output are given in the <code>SELECT</code> clause. The <code>id</code> and <code>title</code> (both from the <code>title</code> table) and the <code>info</code> from the <code>movie_info_idx</code> which represents the number of IMDb votes. * The variables are preceded by the table from which they came. While not always necessary, it is good practice so as to avoid confusion. * The <code>JOIN</code> happens by linking the <code>id</code> variable in the <code>title</code> table with the <code>movie_id</code> variable in the <code>movie_info_idx</code> table. * The <code>LIMIT</code> wasn’t necessary (there are only 12 observations), but it’s good practice so that we don’t end up with unwieldy query results. * The <code>WHERE</code> clause happens before the <code>JOIN</code> action, despite being written after. * In the <code>WHERE</code> clause, we keep only movies, only 2015 production year, and only at least 150,000 votes.</p>
</section>
<section id="join-imdb-title-actress" class="slide level2 scrollable">
<h2><code>JOIN</code> IMDb title + actress</h2>
<p><code>cast_info</code> contains the <code>person_id</code> and the <code>movie_id</code></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode numberSource sql number-lines code-with-copy"><code class="sourceCode sql"><span id="cb20-1"><a href="#cb20-1"></a><span class="kw">SELECT</span> <span class="op">*</span> <span class="kw">FROM</span> cast_info <span class="kw">LIMIT</span> <span class="dv">0</span>, <span class="dv">10</span>;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="knitsql-table">

<table>
<caption>
Displaying records 1 - 10
</caption>
<thead>
<tr>
<th style="text-align:left;">
id
</th>
<th style="text-align:right;">
person_id
</th>
<th style="text-align:right;">
movie_id
</th>
<th style="text-align:right;">
person_role_id
</th>
<th style="text-align:left;">
note
</th>
<th style="text-align:right;">
nr_order
</th>
<th style="text-align:right;">
role_id
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
3432997
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
</td>
<td style="text-align:right;">
31
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
2
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
1901690
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:left;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
3
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
4027567
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:left;">
</td>
<td style="text-align:right;">
25
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
4
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
4282876
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:left;">
</td>
<td style="text-align:right;">
22
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
5
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
3542672
</td>
<td style="text-align:right;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:right;">
12
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
6
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
3331520
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:left;">
(as $hutter Boy)
</td>
<td style="text-align:right;">
10
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
7
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
4027191
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:left;">
(as $hutter Boy)
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
8
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
4195731
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:left;">
(uncredited)
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
9
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
4263956
</td>
<td style="text-align:right;">
6
</td>
<td style="text-align:left;">
(uncredited)
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
10
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
4267787
</td>
<td style="text-align:right;">
7
</td>
<td style="text-align:left;">
(uncredited)
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
1
</td>
</tr>
</tbody>

</table>
</div>
</div>
<p><code>person_role_id</code> is <code>1</code> if actor and <code>2</code> if actress</p>
</section>
<section id="join-imdb-title-actress-1" class="slide level2 scrollable">
<h2><code>JOIN</code> IMDb title + actress</h2>
<p><code>aka_name</code> contains <code>person_id</code> and <code>name</code> (of actor)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode numberSource sql number-lines code-with-copy"><code class="sourceCode sql"><span id="cb21-1"><a href="#cb21-1"></a><span class="kw">SELECT</span> <span class="op">*</span> <span class="kw">FROM</span> aka_name <span class="kw">LIMIT</span> <span class="dv">0</span>, <span class="dv">10</span>;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="knitsql-table">

<table>
<caption>
Displaying records 1 - 10
</caption>
<thead>
<tr>
<th style="text-align:left;">
id
</th>
<th style="text-align:right;">
person_id
</th>
<th style="text-align:left;">
name
</th>
<th style="text-align:left;">
imdb_index
</th>
<th style="text-align:left;">
name_pcode_cf
</th>
<th style="text-align:left;">
name_pcode_nf
</th>
<th style="text-align:left;">
surname_pcode
</th>
<th style="text-align:left;">
md5sum
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
1
</td>
<td style="text-align:right;">
6188450
</td>
<td style="text-align:left;">
Smith, Jessica Noel
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
S5325
</td>
<td style="text-align:left;">
J2542
</td>
<td style="text-align:left;">
S53
</td>
<td style="text-align:left;">
25c9d464e3ff2957533546aa92b397ed
</td>
</tr>
<tr>
<td style="text-align:left;">
2
</td>
<td style="text-align:right;">
5125059
</td>
<td style="text-align:left;">
Pain, L. $ham
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
P545
</td>
<td style="text-align:left;">
L515
</td>
<td style="text-align:left;">
P5
</td>
<td style="text-align:left;">
569b1e885ccb51211c01753f0dad9b2c
</td>
</tr>
<tr>
<td style="text-align:left;">
3
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:left;">
Boy, $hutter
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
B36
</td>
<td style="text-align:left;">
H361
</td>
<td style="text-align:left;">
B
</td>
<td style="text-align:left;">
35092b5604ce378fc48c8a6fc0038a49
</td>
</tr>
<tr>
<td style="text-align:left;">
4
</td>
<td style="text-align:right;">
4152053
</td>
<td style="text-align:left;">
Dollasign, Ty
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
D4253
</td>
<td style="text-align:left;">
T3425
</td>
<td style="text-align:left;">
D425
</td>
<td style="text-align:left;">
0f565a2d8027cfb8ed6c5f4bba719fcd
</td>
</tr>
<tr>
<td style="text-align:left;">
5
</td>
<td style="text-align:right;">
4152053
</td>
<td style="text-align:left;">
Sign, Ty Dolla
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
S2534
</td>
<td style="text-align:left;">
T3425
</td>
<td style="text-align:left;">
S25
</td>
<td style="text-align:left;">
2eded1b021b96333b4b74e0fec959650
</td>
</tr>
<tr>
<td style="text-align:left;">
6
</td>
<td style="text-align:right;">
6
</td>
<td style="text-align:left;">
Moore, Brandon
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
M6165
</td>
<td style="text-align:left;">
B6535
</td>
<td style="text-align:left;">
M6
</td>
<td style="text-align:left;">
193a6f5adf4756320f622162d2475608
</td>
</tr>
<tr>
<td style="text-align:left;">
7
</td>
<td style="text-align:right;">
8
</td>
<td style="text-align:left;">
$torm, Country
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
T6525
</td>
<td style="text-align:left;">
C5363
</td>
<td style="text-align:left;">
T65
</td>
<td style="text-align:left;">
1654400b707d34323ea392b87060e6cc
</td>
</tr>
<tr>
<td style="text-align:left;">
8
</td>
<td style="text-align:right;">
19
</td>
<td style="text-align:left;">
‘Hooper’, Simon P.J. Kelly
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
H1625
</td>
<td style="text-align:left;">
S5124
</td>
<td style="text-align:left;">
H16
</td>
<td style="text-align:left;">
3fd8885372c23f8c74e583da91d1fd05
</td>
</tr>
<tr>
<td style="text-align:left;">
9
</td>
<td style="text-align:right;">
19
</td>
<td style="text-align:left;">
Hooper
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
H16
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
24ddc68ab605ee95857ad45b65ffa2d8
</td>
</tr>
<tr>
<td style="text-align:left;">
10
</td>
<td style="text-align:right;">
19
</td>
<td style="text-align:left;">
Kelly, Simon P.J.
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
K4251
</td>
<td style="text-align:left;">
S5124
</td>
<td style="text-align:left;">
K4
</td>
<td style="text-align:left;">
33d976f22e276b73c61513bc5f6e72a6
</td>
</tr>
</tbody>

</table>
</div>
</div>
</section>
<section id="join-imdb-title-actress-2" class="slide level2 scrollable">
<h2><code>JOIN</code> IMDb title + actress</h2>
<p><code>title</code> contains <code>id</code> and <code>title</code> (of the movie)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode numberSource sql number-lines code-with-copy"><code class="sourceCode sql"><span id="cb22-1"><a href="#cb22-1"></a><span class="kw">SELECT</span> <span class="op">*</span> <span class="kw">FROM</span> title <span class="kw">LIMIT</span> <span class="dv">0</span>, <span class="dv">10</span>;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="knitsql-table">

<table>
<caption>
Displaying records 1 - 10
</caption>
<thead>
<tr>
<th style="text-align:right;">
id
</th>
<th style="text-align:left;">
title
</th>
<th style="text-align:left;">
imdb_index
</th>
<th style="text-align:right;">
kind_id
</th>
<th style="text-align:right;">
production_year
</th>
<th style="text-align:right;">
imdb_id
</th>
<th style="text-align:left;">
phonetic_code
</th>
<th style="text-align:right;">
episode_of_id
</th>
<th style="text-align:right;">
season_nr
</th>
<th style="text-align:right;">
episode_nr
</th>
<th style="text-align:left;">
series_years
</th>
<th style="text-align:left;">
md5sum
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
78460
</td>
<td style="text-align:left;">
Adults Recat to the Simpsons (30th Anniversary)
</td>
<td style="text-align:left;">
</td>
<td style="text-align:right;">
7
</td>
<td style="text-align:right;">
2017
</td>
<td style="text-align:right;">
</td>
<td style="text-align:left;">
A3432
</td>
<td style="text-align:right;">
78406
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
2ae09eed7d576cc2c24774fed5b18168
</td>
</tr>
<tr>
<td style="text-align:right;">
70273
</td>
<td style="text-align:left;">
(2016-05-18)
</td>
<td style="text-align:left;">
</td>
<td style="text-align:right;">
7
</td>
<td style="text-align:right;">
2016
</td>
<td style="text-align:right;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:right;">
68058
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
511dfc14cfff7589d29a95abb30cd66a
</td>
</tr>
<tr>
<td style="text-align:right;">
60105
</td>
<td style="text-align:left;">
(2014-04-11)
</td>
<td style="text-align:left;">
</td>
<td style="text-align:right;">
7
</td>
<td style="text-align:right;">
2014
</td>
<td style="text-align:right;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:right;">
59138
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
c6cdce7e667e07713e431805c407feed
</td>
</tr>
<tr>
<td style="text-align:right;">
32120
</td>
<td style="text-align:left;">
(2008-05-01)
</td>
<td style="text-align:left;">
</td>
<td style="text-align:right;">
7
</td>
<td style="text-align:right;">
2008
</td>
<td style="text-align:right;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:right;">
32060
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
100df65742caf5afd092b2e0ead67d8e
</td>
</tr>
<tr>
<td style="text-align:right;">
97554
</td>
<td style="text-align:left;">
SchmÃ¶lders Traum
</td>
<td style="text-align:left;">
</td>
<td style="text-align:right;">
7
</td>
<td style="text-align:right;">
2001
</td>
<td style="text-align:right;">
</td>
<td style="text-align:left;">
S2543
</td>
<td style="text-align:right;">
97302
</td>
<td style="text-align:right;">
10
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
46862a2f96f9fb2d59e8c9a11ecfdd28
</td>
</tr>
<tr>
<td style="text-align:right;">
57966
</td>
<td style="text-align:left;">
(#1.1)
</td>
<td style="text-align:left;">
</td>
<td style="text-align:right;">
7
</td>
<td style="text-align:right;">
2013
</td>
<td style="text-align:right;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:right;">
57965
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
409c37703766c4b24f8a86162fd9cf85
</td>
</tr>
<tr>
<td style="text-align:right;">
76391
</td>
<td style="text-align:left;">
Anniversary
</td>
<td style="text-align:left;">
</td>
<td style="text-align:right;">
7
</td>
<td style="text-align:right;">
1971
</td>
<td style="text-align:right;">
</td>
<td style="text-align:left;">
A5162
</td>
<td style="text-align:right;">
76385
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
9
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
5e12ce73fac1d1dcf94136b6e9acd8f8
</td>
</tr>
<tr>
<td style="text-align:right;">
11952
</td>
<td style="text-align:left;">
Angus Black/Lester Barrie/DC Curry
</td>
<td style="text-align:left;">
</td>
<td style="text-align:right;">
7
</td>
<td style="text-align:right;">
2009
</td>
<td style="text-align:right;">
</td>
<td style="text-align:left;">
A5214
</td>
<td style="text-align:right;">
11937
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
7
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
9c38b9e5601dc154444b73b518034aa1
</td>
</tr>
<tr>
<td style="text-align:right;">
1554
</td>
<td style="text-align:left;">
New Orleans
</td>
<td style="text-align:left;">
</td>
<td style="text-align:right;">
7
</td>
<td style="text-align:right;">
2003
</td>
<td style="text-align:right;">
</td>
<td style="text-align:left;">
N6452
</td>
<td style="text-align:right;">
1508
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
11
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
621bea735740a547e862e4a3226f35d2
</td>
</tr>
<tr>
<td style="text-align:right;">
58442
</td>
<td style="text-align:left;">
Kiss Me Kate
</td>
<td style="text-align:left;">
</td>
<td style="text-align:right;">
7
</td>
<td style="text-align:right;">
2011
</td>
<td style="text-align:right;">
</td>
<td style="text-align:left;">
K2523
</td>
<td style="text-align:right;">
58436
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
10
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
293e8c75c7f35a4035abf617962be5a9
</td>
</tr>
</tbody>

</table>
</div>
</div>
</section>
<section id="join-imdb-title-actress-3" class="slide level2 scrollable">
<h2><code>JOIN</code> IMDb title + actress</h2>
<p>Goal: identify the actresses in those movies with the highest number of votes.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode numberSource sql number-lines code-with-copy"><code class="sourceCode sql"><span id="cb23-1"><a href="#cb23-1"></a><span class="kw">SELECT</span> t.title,</span>
<span id="cb23-2"><a href="#cb23-2"></a>       idx.info,</span>
<span id="cb23-3"><a href="#cb23-3"></a>       a.person_id,</span>
<span id="cb23-4"><a href="#cb23-4"></a>       n.name</span>
<span id="cb23-5"><a href="#cb23-5"></a><span class="kw">FROM</span> title <span class="kw">AS</span> t</span>
<span id="cb23-6"><a href="#cb23-6"></a><span class="kw">JOIN</span> movie_info_idx <span class="kw">AS</span> idx <span class="kw">ON</span> t.<span class="kw">id</span> <span class="op">=</span> idx.movie_id </span>
<span id="cb23-7"><a href="#cb23-7"></a><span class="kw">JOIN</span> cast_info <span class="kw">AS</span> a <span class="kw">ON</span> idx.movie_id <span class="op">=</span> a.movie_id</span>
<span id="cb23-8"><a href="#cb23-8"></a><span class="kw">JOIN</span> aka_name <span class="kw">AS</span> n <span class="kw">ON</span> a.person_id <span class="op">=</span> n.person_id</span>
<span id="cb23-9"><a href="#cb23-9"></a><span class="kw">WHERE</span> t.production_year <span class="op">=</span> <span class="dv">2015</span> </span>
<span id="cb23-10"><a href="#cb23-10"></a>    <span class="kw">AND</span> t.kind_id <span class="op">=</span> <span class="dv">1</span>           # movies <span class="kw">only</span></span>
<span id="cb23-11"><a href="#cb23-11"></a>    <span class="kw">AND</span> idx.info_type_id <span class="op">=</span> <span class="dv">100</span>  # info_type <span class="kw">is</span> votes</span>
<span id="cb23-12"><a href="#cb23-12"></a>    <span class="kw">AND</span> idx.info <span class="op">&gt;</span> <span class="dv">150000</span>       # <span class="kw">at</span> <span class="fu">least</span> <span class="dv">150</span>,<span class="dv">000</span> votes</span>
<span id="cb23-13"><a href="#cb23-13"></a>    <span class="kw">AND</span> a.role_id <span class="op">=</span> <span class="dv">2</span>           # actresses <span class="kw">only</span></span>
<span id="cb23-14"><a href="#cb23-14"></a><span class="kw">ORDER</span> <span class="kw">BY</span> a.person_id</span>
<span id="cb23-15"><a href="#cb23-15"></a><span class="kw">LIMIT</span> <span class="dv">0</span>, <span class="dv">50</span>;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="knitsql-table">

<table>
<caption>
Displaying records 1 - 10
</caption>
<thead>
<tr>
<th style="text-align:left;">
title
</th>
<th style="text-align:left;">
info
</th>
<th style="text-align:right;">
person_id
</th>
<th style="text-align:left;">
name
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Mission: Impossible - Rogue Nation
</td>
<td style="text-align:left;">
266759
</td>
<td style="text-align:right;">
2674172
</td>
<td style="text-align:left;">
Sofz
</td>
</tr>
<tr>
<td style="text-align:left;">
Mission: Impossible - Rogue Nation
</td>
<td style="text-align:left;">
266759
</td>
<td style="text-align:right;">
2674172
</td>
<td style="text-align:left;">
Sof
</td>
</tr>
<tr>
<td style="text-align:left;">
Mission: Impossible - Rogue Nation
</td>
<td style="text-align:left;">
266759
</td>
<td style="text-align:right;">
2674172
</td>
<td style="text-align:left;">
Sofz
</td>
</tr>
<tr>
<td style="text-align:left;">
Mission: Impossible - Rogue Nation
</td>
<td style="text-align:left;">
266759
</td>
<td style="text-align:right;">
2674172
</td>
<td style="text-align:left;">
Sof
</td>
</tr>
<tr>
<td style="text-align:left;">
Focus
</td>
<td style="text-align:left;">
172680
</td>
<td style="text-align:right;">
2678594
</td>
<td style="text-align:left;">
Labouisse, Kate
</td>
</tr>
<tr>
<td style="text-align:left;">
Mad Max: Fury Road
</td>
<td style="text-align:left;">
666484
</td>
<td style="text-align:right;">
2681098
</td>
<td style="text-align:left;">
Michelle, Debra
</td>
</tr>
<tr>
<td style="text-align:left;">
The Hunger Games: Mockingjay - Part 2
</td>
<td style="text-align:left;">
214569
</td>
<td style="text-align:right;">
2685496
</td>
<td style="text-align:left;">
Harris, Ahnie
</td>
</tr>
<tr>
<td style="text-align:left;">
The Hunger Games: Mockingjay - Part 2
</td>
<td style="text-align:left;">
214569
</td>
<td style="text-align:right;">
2685496
</td>
<td style="text-align:left;">
Harris, Jasmine
</td>
</tr>
<tr>
<td style="text-align:left;">
Creed
</td>
<td style="text-align:left;">
183904
</td>
<td style="text-align:right;">
2686218
</td>
<td style="text-align:left;">
Kareema, Kiana A.
</td>
</tr>
<tr>
<td style="text-align:left;">
Ant-Man
</td>
<td style="text-align:left;">
390965
</td>
<td style="text-align:right;">
2687271
</td>
<td style="text-align:left;">
Akana, Anna Kay
</td>
</tr>
</tbody>

</table>
</div>
</div>
<p>Connecting the most popular movies of 2015 with the actresses in those movies requires a series of <code>JOIN</code>s. Note that to make the code less onerous, the <code>title</code> table has been aliased by <code>t</code>, the <code>movie_info_idx</code> table has been aliased by <code>idx</code>, the <code>cast_info</code> table has been aliased by <code>a</code>, and the <code>aka_name</code> table has been aliased by <code>n</code>.</p>
<p>There is a lot of data cleaning to do as some of the <code>person_id</code> values are one to many!! That is, the <code>person_id</code> matches multiple names in the <code>aka_name</code> database.</p>
</section>
<section id="other-joins" class="slide level2">
<h2>Other <code>JOIN</code>s</h2>
<p>Let’s look at <code>RIGHT JOIN</code> and <code>LEFT JOIN</code> using two new smaller tables.</p>
<ol type="1">
<li><p>The first has seven movies in it (from 2015 with at least 400,000 IMDb votes).</p></li>
<li><p>The second consists of almost 3 million actresses (<code>person_role_id = 2</code>). In order to find a subset of actresses, the <code>person_id &gt; 3900000</code> was set arbitrarily (in order to have a smaller group with which to work).</p></li>
</ol>
<p>Using subqueries, we can <code>JOIN</code> the two datasets using different <code>JOIN</code> techniques.</p>
</section>
<section id="movies" class="slide level2 scrollable">
<h2>movies:</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode numberSource sql number-lines code-with-copy"><code class="sourceCode sql"><span id="cb24-1"><a href="#cb24-1"></a><span class="kw">SELECT</span> t.<span class="kw">id</span>,</span>
<span id="cb24-2"><a href="#cb24-2"></a>       t.title,</span>
<span id="cb24-3"><a href="#cb24-3"></a>       idx.info,</span>
<span id="cb24-4"><a href="#cb24-4"></a>       (<span class="kw">SELECT</span> <span class="fu">COUNT</span>(<span class="op">*</span>)</span>
<span id="cb24-5"><a href="#cb24-5"></a>       <span class="kw">FROM</span> title <span class="kw">AS</span> t</span>
<span id="cb24-6"><a href="#cb24-6"></a>       <span class="kw">JOIN</span> movie_info_idx <span class="kw">AS</span> idx <span class="kw">ON</span> idx.movie_id <span class="op">=</span> t.<span class="kw">id</span></span>
<span id="cb24-7"><a href="#cb24-7"></a>       <span class="kw">WHERE</span> t.production_year <span class="op">=</span> <span class="dv">2015</span>  </span>
<span id="cb24-8"><a href="#cb24-8"></a>             <span class="kw">AND</span> t.kind_id <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb24-9"><a href="#cb24-9"></a>             <span class="kw">AND</span> idx.info_type_id <span class="op">=</span> <span class="dv">100</span></span>
<span id="cb24-10"><a href="#cb24-10"></a>             <span class="kw">AND</span> idx.info <span class="op">&gt;</span> <span class="dv">400000</span>) <span class="kw">AS</span> row_count</span>
<span id="cb24-11"><a href="#cb24-11"></a><span class="kw">FROM</span> title <span class="kw">AS</span> t</span>
<span id="cb24-12"><a href="#cb24-12"></a><span class="kw">JOIN</span> movie_info_idx <span class="kw">AS</span> idx <span class="kw">ON</span> idx.movie_id <span class="op">=</span> t.<span class="kw">id</span></span>
<span id="cb24-13"><a href="#cb24-13"></a><span class="kw">WHERE</span> t.production_year <span class="op">=</span> <span class="dv">2015</span>  </span>
<span id="cb24-14"><a href="#cb24-14"></a>    <span class="kw">AND</span> t.kind_id <span class="op">=</span> <span class="dv">1</span>             # movies <span class="kw">only</span></span>
<span id="cb24-15"><a href="#cb24-15"></a>    <span class="kw">AND</span> idx.info_type_id <span class="op">=</span> <span class="dv">100</span>    # info_type <span class="kw">is</span> votes</span>
<span id="cb24-16"><a href="#cb24-16"></a>    <span class="kw">AND</span> idx.info <span class="op">&gt;</span> <span class="dv">400000</span>         # <span class="kw">at</span> <span class="fu">least</span> <span class="dv">400</span>,<span class="dv">000</span> votes</span>
<span id="cb24-17"><a href="#cb24-17"></a><span class="kw">ORDER</span> <span class="kw">BY</span> idx.info <span class="kw">DESC</span>;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="knitsql-table">

<table>
<caption>
7 records
</caption>
<thead>
<tr>
<th style="text-align:right;">
id
</th>
<th style="text-align:left;">
title
</th>
<th style="text-align:left;">
info
</th>
<th style="text-align:right;">
row_count
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
4260166
</td>
<td style="text-align:left;">
Star Wars: Episode VII - The Force Awakens
</td>
<td style="text-align:left;">
691691
</td>
<td style="text-align:right;">
7
</td>
</tr>
<tr>
<td style="text-align:right;">
3915213
</td>
<td style="text-align:left;">
Mad Max: Fury Road
</td>
<td style="text-align:left;">
666484
</td>
<td style="text-align:right;">
7
</td>
</tr>
<tr>
<td style="text-align:right;">
4389619
</td>
<td style="text-align:left;">
The Martian
</td>
<td style="text-align:left;">
583987
</td>
<td style="text-align:right;">
7
</td>
</tr>
<tr>
<td style="text-align:right;">
3313672
</td>
<td style="text-align:left;">
Avengers: Age of Ultron
</td>
<td style="text-align:left;">
540606
</td>
<td style="text-align:right;">
7
</td>
</tr>
<tr>
<td style="text-align:right;">
4414139
</td>
<td style="text-align:left;">
The Revenant
</td>
<td style="text-align:left;">
526189
</td>
<td style="text-align:right;">
7
</td>
</tr>
<tr>
<td style="text-align:right;">
3787790
</td>
<td style="text-align:left;">
Jurassic World
</td>
<td style="text-align:left;">
471237
</td>
<td style="text-align:right;">
7
</td>
</tr>
<tr>
<td style="text-align:right;">
3752999
</td>
<td style="text-align:left;">
Inside Out
</td>
<td style="text-align:left;">
443051
</td>
<td style="text-align:right;">
7
</td>
</tr>
</tbody>

</table>
</div>
</div>
</section>
<section id="actresses" class="slide level2 scrollable">
<h2>actresses:</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode numberSource sql number-lines code-with-copy"><code class="sourceCode sql"><span id="cb25-1"><a href="#cb25-1"></a></span>
<span id="cb25-2"><a href="#cb25-2"></a><span class="kw">SELECT</span> a.person_id,</span>
<span id="cb25-3"><a href="#cb25-3"></a>       a.movie_id,</span>
<span id="cb25-4"><a href="#cb25-4"></a>       n.name,</span>
<span id="cb25-5"><a href="#cb25-5"></a>       (<span class="kw">SELECT</span> <span class="fu">COUNT</span>(<span class="op">*</span>)</span>
<span id="cb25-6"><a href="#cb25-6"></a>       <span class="kw">FROM</span> cast_info <span class="kw">AS</span> a</span>
<span id="cb25-7"><a href="#cb25-7"></a>       <span class="kw">JOIN</span> aka_name <span class="kw">AS</span> n <span class="kw">ON</span> a.person_id <span class="op">=</span> n.person_id</span>
<span id="cb25-8"><a href="#cb25-8"></a>       <span class="kw">WHERE</span> a.person_role_id <span class="op">=</span> <span class="dv">2</span>  </span>
<span id="cb25-9"><a href="#cb25-9"></a>             <span class="kw">AND</span> a.person_id <span class="op">&gt;</span> <span class="dv">390000</span>) <span class="kw">AS</span> row_count</span>
<span id="cb25-10"><a href="#cb25-10"></a><span class="kw">FROM</span> cast_info <span class="kw">AS</span> a</span>
<span id="cb25-11"><a href="#cb25-11"></a><span class="kw">JOIN</span> aka_name <span class="kw">AS</span> n <span class="kw">ON</span> a.person_id <span class="op">=</span> n.person_id</span>
<span id="cb25-12"><a href="#cb25-12"></a>       <span class="kw">WHERE</span> a.person_role_id <span class="op">=</span> <span class="dv">2</span>  </span>
<span id="cb25-13"><a href="#cb25-13"></a>             <span class="kw">AND</span> a.person_id <span class="op">&gt;</span> <span class="dv">3900000</span></span>
<span id="cb25-14"><a href="#cb25-14"></a><span class="kw">LIMIT</span> <span class="dv">0</span>, <span class="dv">20</span>;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="knitsql-table">

<table>
<caption>
Displaying records 1 - 10
</caption>
<thead>
<tr>
<th style="text-align:right;">
person_id
</th>
<th style="text-align:right;">
movie_id
</th>
<th style="text-align:left;">
name
</th>
<th style="text-align:right;">
row_count
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
3900141
</td>
<td style="text-align:right;">
759802
</td>
<td style="text-align:left;">
Simons, Rita Joanne
</td>
<td style="text-align:right;">
2904759
</td>
</tr>
<tr>
<td style="text-align:right;">
3902258
</td>
<td style="text-align:right;">
4365829
</td>
<td style="text-align:left;">
Singer, Rabbi Tovia
</td>
<td style="text-align:right;">
2904759
</td>
</tr>
<tr>
<td style="text-align:right;">
3902699
</td>
<td style="text-align:right;">
3109788
</td>
<td style="text-align:left;">
Singh, Sabine Erika
</td>
<td style="text-align:right;">
2904759
</td>
</tr>
<tr>
<td style="text-align:right;">
3903035
</td>
<td style="text-align:right;">
3215866
</td>
<td style="text-align:left;">
Val
</td>
<td style="text-align:right;">
2904759
</td>
</tr>
<tr>
<td style="text-align:right;">
3904831
</td>
<td style="text-align:right;">
2468067
</td>
<td style="text-align:left;">
Masha
</td>
<td style="text-align:right;">
2904759
</td>
</tr>
<tr>
<td style="text-align:right;">
3904928
</td>
<td style="text-align:right;">
3654347
</td>
<td style="text-align:left;">
Fei, Siu Yin
</td>
<td style="text-align:right;">
2904759
</td>
</tr>
<tr>
<td style="text-align:right;">
3904928
</td>
<td style="text-align:right;">
3654347
</td>
<td style="text-align:left;">
Hsiao, Yen-fei
</td>
<td style="text-align:right;">
2904759
</td>
</tr>
<tr>
<td style="text-align:right;">
3904928
</td>
<td style="text-align:right;">
3654347
</td>
<td style="text-align:left;">
Siu, Yinfei
</td>
<td style="text-align:right;">
2904759
</td>
</tr>
<tr>
<td style="text-align:right;">
3904928
</td>
<td style="text-align:right;">
3654347
</td>
<td style="text-align:left;">
Xiao, Yanfei
</td>
<td style="text-align:right;">
2904759
</td>
</tr>
<tr>
<td style="text-align:right;">
3904928
</td>
<td style="text-align:right;">
3654347
</td>
<td style="text-align:left;">
Yin-Fai, Siu
</td>
<td style="text-align:right;">
2904759
</td>
</tr>
</tbody>

</table>
</div>
</div>
</section>
<section id="inner-join" class="slide level2 scrollable">
<h2>Inner <code>JOIN</code></h2>
<p>With an inner <code>JOIN</code>, there are 32 rows corresponding to all the actresses in the seven 2015 films with the most votes. Because the <code>JOIN</code> is an intersection of the two tables, only the actresses with <code>person_id</code> above 3900000 are included.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode numberSource sql number-lines code-with-copy"><code class="sourceCode sql"><span id="cb26-1"><a href="#cb26-1"></a><span class="kw">SELECT</span> <span class="op">*</span> <span class="kw">FROM</span></span>
<span id="cb26-2"><a href="#cb26-2"></a>(<span class="kw">SELECT</span> t.<span class="kw">id</span>,</span>
<span id="cb26-3"><a href="#cb26-3"></a>       t.title</span>
<span id="cb26-4"><a href="#cb26-4"></a><span class="kw">FROM</span> title <span class="kw">AS</span> t</span>
<span id="cb26-5"><a href="#cb26-5"></a><span class="kw">JOIN</span> movie_info_idx <span class="kw">AS</span> idx <span class="kw">ON</span> idx.movie_id <span class="op">=</span> t.<span class="kw">id</span></span>
<span id="cb26-6"><a href="#cb26-6"></a><span class="kw">WHERE</span> t.production_year <span class="op">=</span> <span class="dv">2015</span>  </span>
<span id="cb26-7"><a href="#cb26-7"></a>    <span class="kw">AND</span> t.kind_id <span class="op">=</span> <span class="dv">1</span>               # movies <span class="kw">only</span></span>
<span id="cb26-8"><a href="#cb26-8"></a>    <span class="kw">AND</span> idx.info_type_id <span class="op">=</span> <span class="dv">100</span>      # info_type <span class="kw">is</span> votes</span>
<span id="cb26-9"><a href="#cb26-9"></a>    <span class="kw">AND</span> idx.info <span class="op">&gt;</span> <span class="dv">400000</span>) <span class="kw">AS</span> movs  # <span class="kw">at</span> <span class="fu">least</span> <span class="dv">400</span>,<span class="dv">000</span> votes     </span>
<span id="cb26-10"><a href="#cb26-10"></a><span class="kw">INNER</span> <span class="kw">JOIN</span> (<span class="kw">SELECT</span> a.person_id,</span>
<span id="cb26-11"><a href="#cb26-11"></a>       a.movie_id,</span>
<span id="cb26-12"><a href="#cb26-12"></a>       n.name</span>
<span id="cb26-13"><a href="#cb26-13"></a>    <span class="kw">FROM</span> cast_info <span class="kw">AS</span> a</span>
<span id="cb26-14"><a href="#cb26-14"></a>    <span class="kw">JOIN</span> aka_name <span class="kw">AS</span> n <span class="kw">ON</span> a.person_id <span class="op">=</span> n.person_id</span>
<span id="cb26-15"><a href="#cb26-15"></a>    <span class="kw">WHERE</span> a.role_id <span class="op">=</span> <span class="dv">2</span>             # acresses <span class="kw">only</span></span>
<span id="cb26-16"><a href="#cb26-16"></a>        <span class="kw">AND</span> a.person_id <span class="op">&gt;</span> <span class="dv">3900000</span>) <span class="kw">AS</span> acts <span class="kw">ON</span> acts.movie_id <span class="op">=</span> movs.<span class="kw">id</span></span>
<span id="cb26-17"><a href="#cb26-17"></a><span class="kw">LIMIT</span> <span class="dv">0</span>, <span class="dv">300</span>;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="knitsql-table">

<table>
<caption>
Displaying records 1 - 10
</caption>
<thead>
<tr>
<th style="text-align:right;">
id
</th>
<th style="text-align:left;">
title
</th>
<th style="text-align:right;">
person_id
</th>
<th style="text-align:right;">
movie_id
</th>
<th style="text-align:left;">
name
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
3313672
</td>
<td style="text-align:left;">
Avengers: Age of Ultron
</td>
<td style="text-align:right;">
3916648
</td>
<td style="text-align:right;">
3313672
</td>
<td style="text-align:left;">
Smulders, Jacoba Francisca Maria
</td>
</tr>
<tr>
<td style="text-align:right;">
3752999
</td>
<td style="text-align:left;">
Inside Out
</td>
<td style="text-align:right;">
4122876
</td>
<td style="text-align:right;">
3752999
</td>
<td style="text-align:left;">
Kuzniar, Lennon Wynn
</td>
</tr>
<tr>
<td style="text-align:right;">
3787790
</td>
<td style="text-align:left;">
Jurassic World
</td>
<td style="text-align:right;">
3938423
</td>
<td style="text-align:right;">
3787790
</td>
<td style="text-align:left;">
Norvell, Ingrid
</td>
</tr>
<tr>
<td style="text-align:right;">
3787790
</td>
<td style="text-align:left;">
Jurassic World
</td>
<td style="text-align:right;">
3938423
</td>
<td style="text-align:right;">
3787790
</td>
<td style="text-align:left;">
Norvell, Ingrid
</td>
</tr>
<tr>
<td style="text-align:right;">
3787790
</td>
<td style="text-align:left;">
Jurassic World
</td>
<td style="text-align:right;">
3950111
</td>
<td style="text-align:right;">
3787790
</td>
<td style="text-align:left;">
Sallaway, Seannon Jane
</td>
</tr>
<tr>
<td style="text-align:right;">
3787790
</td>
<td style="text-align:left;">
Jurassic World
</td>
<td style="text-align:right;">
4079047
</td>
<td style="text-align:right;">
3787790
</td>
<td style="text-align:left;">
Washington, Kelly Lynn
</td>
</tr>
<tr>
<td style="text-align:right;">
3787790
</td>
<td style="text-align:left;">
Jurassic World
</td>
<td style="text-align:right;">
4079047
</td>
<td style="text-align:right;">
3787790
</td>
<td style="text-align:left;">
Washington, Kelly Lynn
</td>
</tr>
<tr>
<td style="text-align:right;">
3787790
</td>
<td style="text-align:left;">
Jurassic World
</td>
<td style="text-align:right;">
4084626
</td>
<td style="text-align:right;">
3787790
</td>
<td style="text-align:left;">
Weeks, Jency
</td>
</tr>
<tr>
<td style="text-align:right;">
3787790
</td>
<td style="text-align:left;">
Jurassic World
</td>
<td style="text-align:right;">
4084626
</td>
<td style="text-align:right;">
3787790
</td>
<td style="text-align:left;">
Jenc
</td>
</tr>
<tr>
<td style="text-align:right;">
3787790
</td>
<td style="text-align:left;">
Jurassic World
</td>
<td style="text-align:right;">
4084626
</td>
<td style="text-align:right;">
3787790
</td>
<td style="text-align:left;">
Little J
</td>
</tr>
</tbody>

</table>
</div>
</div>
</section>
<section id="right-join" class="slide level2 scrollable">
<h2><code>RIGHT JOIN</code></h2>
<p>With a <code>RIGHT JOIN</code>, there are more than 300 rows (the <code>LIMIT</code> clause keeps us from knowing how many rows, but there are a LOT!) corresponding to all the actresses whose <code>person_id</code> above 3900000 are included. Those actresses who acted in one of the seven top 2015 films are also included in the full results table, but they don’t happen to be in the truncated output here.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode numberSource sql number-lines code-with-copy"><code class="sourceCode sql"><span id="cb27-1"><a href="#cb27-1"></a><span class="kw">SELECT</span> <span class="op">*</span> <span class="kw">FROM</span></span>
<span id="cb27-2"><a href="#cb27-2"></a>(<span class="kw">SELECT</span> t.<span class="kw">id</span>,</span>
<span id="cb27-3"><a href="#cb27-3"></a>       t.title</span>
<span id="cb27-4"><a href="#cb27-4"></a><span class="kw">FROM</span> title <span class="kw">AS</span> t</span>
<span id="cb27-5"><a href="#cb27-5"></a><span class="kw">JOIN</span> movie_info_idx <span class="kw">AS</span> idx <span class="kw">ON</span> idx.movie_id <span class="op">=</span> t.<span class="kw">id</span></span>
<span id="cb27-6"><a href="#cb27-6"></a><span class="kw">WHERE</span> t.production_year <span class="op">=</span> <span class="dv">2015</span>  </span>
<span id="cb27-7"><a href="#cb27-7"></a>    <span class="kw">AND</span> t.kind_id <span class="op">=</span> <span class="dv">1</span>               # movies <span class="kw">only</span></span>
<span id="cb27-8"><a href="#cb27-8"></a>    <span class="kw">AND</span> idx.info_type_id <span class="op">=</span> <span class="dv">100</span>      # info_type <span class="kw">is</span> votes</span>
<span id="cb27-9"><a href="#cb27-9"></a>    <span class="kw">AND</span> idx.info <span class="op">&gt;</span> <span class="dv">400000</span>) <span class="kw">AS</span> movs  # <span class="kw">at</span> <span class="fu">least</span> <span class="dv">400</span>,<span class="dv">000</span> votes     </span>
<span id="cb27-10"><a href="#cb27-10"></a><span class="kw">RIGHT</span> <span class="kw">JOIN</span> (<span class="kw">SELECT</span> a.person_id,</span>
<span id="cb27-11"><a href="#cb27-11"></a>       a.movie_id,</span>
<span id="cb27-12"><a href="#cb27-12"></a>       n.name</span>
<span id="cb27-13"><a href="#cb27-13"></a>    <span class="kw">FROM</span> cast_info <span class="kw">AS</span> a</span>
<span id="cb27-14"><a href="#cb27-14"></a>    <span class="kw">JOIN</span> aka_name <span class="kw">AS</span> n <span class="kw">ON</span> a.person_id <span class="op">=</span> n.person_id</span>
<span id="cb27-15"><a href="#cb27-15"></a>    <span class="kw">WHERE</span> a.role_id <span class="op">=</span> <span class="dv">2</span>             # acresses <span class="kw">only</span></span>
<span id="cb27-16"><a href="#cb27-16"></a>        <span class="kw">AND</span> a.person_id <span class="op">&gt;</span> <span class="dv">3900000</span>) <span class="kw">AS</span> acts <span class="kw">ON</span> acts.movie_id <span class="op">=</span> movs.<span class="kw">id</span></span>
<span id="cb27-17"><a href="#cb27-17"></a><span class="kw">LIMIT</span> <span class="dv">0</span>, <span class="dv">300</span>;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="knitsql-table">

<table>
<caption>
Displaying records 1 - 10
</caption>
<thead>
<tr>
<th style="text-align:right;">
id
</th>
<th style="text-align:left;">
title
</th>
<th style="text-align:right;">
person_id
</th>
<th style="text-align:right;">
movie_id
</th>
<th style="text-align:left;">
name
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:right;">
3900001
</td>
<td style="text-align:right;">
3355298
</td>
<td style="text-align:left;">
Simonis, Heidi
</td>
</tr>
<tr>
<td style="text-align:right;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:right;">
3900001
</td>
<td style="text-align:right;">
3509490
</td>
<td style="text-align:left;">
Simonis, Heidi
</td>
</tr>
<tr>
<td style="text-align:right;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:right;">
3900001
</td>
<td style="text-align:right;">
3739780
</td>
<td style="text-align:left;">
Simonis, Heidi
</td>
</tr>
<tr>
<td style="text-align:right;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:right;">
3900001
</td>
<td style="text-align:right;">
3943329
</td>
<td style="text-align:left;">
Simonis, Heidi
</td>
</tr>
<tr>
<td style="text-align:right;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:right;">
3900001
</td>
<td style="text-align:right;">
165963
</td>
<td style="text-align:left;">
Simonis, Heidi
</td>
</tr>
<tr>
<td style="text-align:right;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:right;">
3900001
</td>
<td style="text-align:right;">
268249
</td>
<td style="text-align:left;">
Simonis, Heidi
</td>
</tr>
<tr>
<td style="text-align:right;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:right;">
3900001
</td>
<td style="text-align:right;">
268370
</td>
<td style="text-align:left;">
Simonis, Heidi
</td>
</tr>
<tr>
<td style="text-align:right;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:right;">
3900001
</td>
<td style="text-align:right;">
268406
</td>
<td style="text-align:left;">
Simonis, Heidi
</td>
</tr>
<tr>
<td style="text-align:right;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:right;">
3900001
</td>
<td style="text-align:right;">
268475
</td>
<td style="text-align:left;">
Simonis, Heidi
</td>
</tr>
<tr>
<td style="text-align:right;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:right;">
3900001
</td>
<td style="text-align:right;">
279082
</td>
<td style="text-align:left;">
Simonis, Heidi
</td>
</tr>
</tbody>

</table>
</div>
</div>
</section>
<section id="left-join" class="slide level2 scrollable">
<h2><code>LEFT JOIN</code></h2>
<p>With a <code>LEFT JOIN</code>, there are 33 rows corresponding to the actresses in the seven top 2015 movies. Only <strong>The Revenant</strong> did not have any actresses whose <code>person_id</code> is greater than 3900000.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode numberSource sql number-lines code-with-copy"><code class="sourceCode sql"><span id="cb28-1"><a href="#cb28-1"></a><span class="kw">SELECT</span> <span class="op">*</span> <span class="kw">FROM</span></span>
<span id="cb28-2"><a href="#cb28-2"></a>(<span class="kw">SELECT</span> t.<span class="kw">id</span>,</span>
<span id="cb28-3"><a href="#cb28-3"></a>       t.title</span>
<span id="cb28-4"><a href="#cb28-4"></a><span class="kw">FROM</span> title <span class="kw">AS</span> t</span>
<span id="cb28-5"><a href="#cb28-5"></a><span class="kw">JOIN</span> movie_info_idx <span class="kw">AS</span> idx <span class="kw">ON</span> idx.movie_id <span class="op">=</span> t.<span class="kw">id</span></span>
<span id="cb28-6"><a href="#cb28-6"></a><span class="kw">WHERE</span> t.production_year <span class="op">=</span> <span class="dv">2015</span>  </span>
<span id="cb28-7"><a href="#cb28-7"></a>    <span class="kw">AND</span> t.kind_id <span class="op">=</span> <span class="dv">1</span>               # movies <span class="kw">only</span></span>
<span id="cb28-8"><a href="#cb28-8"></a>    <span class="kw">AND</span> idx.info_type_id <span class="op">=</span> <span class="dv">100</span>      # info_type <span class="kw">is</span> votes</span>
<span id="cb28-9"><a href="#cb28-9"></a>    <span class="kw">AND</span> idx.info <span class="op">&gt;</span> <span class="dv">400000</span>) <span class="kw">AS</span> movs  # <span class="kw">at</span> <span class="fu">least</span> <span class="dv">400</span>,<span class="dv">000</span> votes     </span>
<span id="cb28-10"><a href="#cb28-10"></a><span class="kw">LEFT</span> <span class="kw">JOIN</span> (<span class="kw">SELECT</span> a.person_id,</span>
<span id="cb28-11"><a href="#cb28-11"></a>       a.movie_id,</span>
<span id="cb28-12"><a href="#cb28-12"></a>       n.name</span>
<span id="cb28-13"><a href="#cb28-13"></a>    <span class="kw">FROM</span> cast_info <span class="kw">AS</span> a</span>
<span id="cb28-14"><a href="#cb28-14"></a>    <span class="kw">JOIN</span> aka_name <span class="kw">AS</span> n <span class="kw">ON</span> a.person_id <span class="op">=</span> n.person_id</span>
<span id="cb28-15"><a href="#cb28-15"></a>    <span class="kw">WHERE</span> a.role_id <span class="op">=</span> <span class="dv">2</span>             # acresses <span class="kw">only</span></span>
<span id="cb28-16"><a href="#cb28-16"></a>        <span class="kw">AND</span> a.person_id <span class="op">&gt;</span> <span class="dv">3900000</span>) <span class="kw">AS</span> acts <span class="kw">ON</span> acts.movie_id <span class="op">=</span> movs.<span class="kw">id</span></span>
<span id="cb28-17"><a href="#cb28-17"></a><span class="kw">LIMIT</span> <span class="dv">0</span>, <span class="dv">300</span>;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="knitsql-table">

<table>
<caption>
Displaying records 1 - 10
</caption>
<thead>
<tr>
<th style="text-align:right;">
id
</th>
<th style="text-align:left;">
title
</th>
<th style="text-align:right;">
person_id
</th>
<th style="text-align:right;">
movie_id
</th>
<th style="text-align:left;">
name
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
3313672
</td>
<td style="text-align:left;">
Avengers: Age of Ultron
</td>
<td style="text-align:right;">
3916648
</td>
<td style="text-align:right;">
3313672
</td>
<td style="text-align:left;">
Smulders, Jacoba Francisca Maria
</td>
</tr>
<tr>
<td style="text-align:right;">
3752999
</td>
<td style="text-align:left;">
Inside Out
</td>
<td style="text-align:right;">
4122876
</td>
<td style="text-align:right;">
3752999
</td>
<td style="text-align:left;">
Kuzniar, Lennon Wynn
</td>
</tr>
<tr>
<td style="text-align:right;">
3787790
</td>
<td style="text-align:left;">
Jurassic World
</td>
<td style="text-align:right;">
3938423
</td>
<td style="text-align:right;">
3787790
</td>
<td style="text-align:left;">
Norvell, Ingrid
</td>
</tr>
<tr>
<td style="text-align:right;">
3787790
</td>
<td style="text-align:left;">
Jurassic World
</td>
<td style="text-align:right;">
3938423
</td>
<td style="text-align:right;">
3787790
</td>
<td style="text-align:left;">
Norvell, Ingrid
</td>
</tr>
<tr>
<td style="text-align:right;">
3787790
</td>
<td style="text-align:left;">
Jurassic World
</td>
<td style="text-align:right;">
3950111
</td>
<td style="text-align:right;">
3787790
</td>
<td style="text-align:left;">
Sallaway, Seannon Jane
</td>
</tr>
<tr>
<td style="text-align:right;">
3787790
</td>
<td style="text-align:left;">
Jurassic World
</td>
<td style="text-align:right;">
4079047
</td>
<td style="text-align:right;">
3787790
</td>
<td style="text-align:left;">
Washington, Kelly Lynn
</td>
</tr>
<tr>
<td style="text-align:right;">
3787790
</td>
<td style="text-align:left;">
Jurassic World
</td>
<td style="text-align:right;">
4079047
</td>
<td style="text-align:right;">
3787790
</td>
<td style="text-align:left;">
Washington, Kelly Lynn
</td>
</tr>
<tr>
<td style="text-align:right;">
3787790
</td>
<td style="text-align:left;">
Jurassic World
</td>
<td style="text-align:right;">
4084626
</td>
<td style="text-align:right;">
3787790
</td>
<td style="text-align:left;">
Weeks, Jency
</td>
</tr>
<tr>
<td style="text-align:right;">
3787790
</td>
<td style="text-align:left;">
Jurassic World
</td>
<td style="text-align:right;">
4084626
</td>
<td style="text-align:right;">
3787790
</td>
<td style="text-align:left;">
Jenc
</td>
</tr>
<tr>
<td style="text-align:right;">
3787790
</td>
<td style="text-align:left;">
Jurassic World
</td>
<td style="text-align:right;">
4084626
</td>
<td style="text-align:right;">
3787790
</td>
<td style="text-align:left;">
Little J
</td>
</tr>
</tbody>

</table>
</div>
</div>
</section>
<section id="counting-repeat-actresses" class="slide level2 scrollable">
<h2>Counting repeat actresses</h2>
<p>We might, for example, want to know how many names / spellings of a name with a specific <code>person_id</code> (above 3900000) exist for each <code>person_id</code> in each of the top voted seven films of 2015.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode numberSource sql number-lines code-with-copy"><code class="sourceCode sql"><span id="cb29-1"><a href="#cb29-1"></a><span class="kw">SELECT</span> acts.person_id, </span>
<span id="cb29-2"><a href="#cb29-2"></a>       <span class="fu">COUNT</span>(<span class="op">*</span>) <span class="kw">AS</span> num_repeat_names</span>
<span id="cb29-3"><a href="#cb29-3"></a><span class="kw">FROM</span> (<span class="kw">SELECT</span> t.<span class="kw">id</span>,</span>
<span id="cb29-4"><a href="#cb29-4"></a>       t.title</span>
<span id="cb29-5"><a href="#cb29-5"></a><span class="kw">FROM</span> title <span class="kw">AS</span> t</span>
<span id="cb29-6"><a href="#cb29-6"></a><span class="kw">JOIN</span> movie_info_idx <span class="kw">AS</span> idx <span class="kw">ON</span> idx.movie_id <span class="op">=</span> t.<span class="kw">id</span></span>
<span id="cb29-7"><a href="#cb29-7"></a><span class="kw">WHERE</span> t.production_year <span class="op">=</span> <span class="dv">2015</span>  </span>
<span id="cb29-8"><a href="#cb29-8"></a>    <span class="kw">AND</span> t.kind_id <span class="op">=</span> <span class="dv">1</span>               # movies <span class="kw">only</span></span>
<span id="cb29-9"><a href="#cb29-9"></a>    <span class="kw">AND</span> idx.info_type_id <span class="op">=</span> <span class="dv">100</span>      # info_type <span class="kw">is</span> votes</span>
<span id="cb29-10"><a href="#cb29-10"></a>    <span class="kw">AND</span> idx.info <span class="op">&gt;</span> <span class="dv">400000</span>) <span class="kw">AS</span> movs  # <span class="kw">at</span> <span class="fu">least</span> <span class="dv">400</span>,<span class="dv">000</span> votes</span>
<span id="cb29-11"><a href="#cb29-11"></a><span class="kw">JOIN</span> (<span class="kw">SELECT</span> a.person_id,</span>
<span id="cb29-12"><a href="#cb29-12"></a>       a.movie_id,</span>
<span id="cb29-13"><a href="#cb29-13"></a>       n.name</span>
<span id="cb29-14"><a href="#cb29-14"></a>    <span class="kw">FROM</span> cast_info <span class="kw">AS</span> a</span>
<span id="cb29-15"><a href="#cb29-15"></a>    <span class="kw">JOIN</span> aka_name <span class="kw">AS</span> n <span class="kw">ON</span> a.person_id <span class="op">=</span> n.person_id</span>
<span id="cb29-16"><a href="#cb29-16"></a>    <span class="kw">WHERE</span> a.role_id <span class="op">=</span> <span class="dv">2</span>             # acresses <span class="kw">only</span></span>
<span id="cb29-17"><a href="#cb29-17"></a>        <span class="kw">AND</span> a.person_id <span class="op">&gt;</span> <span class="dv">3900000</span>) <span class="kw">AS</span> acts <span class="kw">ON</span> acts.movie_id <span class="op">=</span> movs.<span class="kw">id</span></span>
<span id="cb29-18"><a href="#cb29-18"></a><span class="kw">GROUP</span> <span class="kw">BY</span> acts.person_id;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="knitsql-table">

<table>
<caption>
Displaying records 1 - 10
</caption>
<thead>
<tr>
<th style="text-align:right;">
person_id
</th>
<th style="text-align:right;">
num_repeat_names
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
3916648
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:right;">
4122876
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:right;">
3938423
</td>
<td style="text-align:right;">
2
</td>
</tr>
<tr>
<td style="text-align:right;">
3950111
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:right;">
4079047
</td>
<td style="text-align:right;">
2
</td>
</tr>
<tr>
<td style="text-align:right;">
4084626
</td>
<td style="text-align:right;">
3
</td>
</tr>
<tr>
<td style="text-align:right;">
4099458
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:right;">
3958614
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:right;">
3990819
</td>
<td style="text-align:right;">
2
</td>
</tr>
<tr>
<td style="text-align:right;">
4081131
</td>
<td style="text-align:right;">
2
</td>
</tr>
</tbody>

</table>
</div>
</div>
</section>
<section id="counting-number-of-actresses-per-film" class="slide level2 scrollable">
<h2>Counting number of actresses per film</h2>
<p>We might, for example, want to know how many actresses with a specific <code>person_id</code> (above 3900000) are in each of the top voted seven films of 2015.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode numberSource sql number-lines code-with-copy"><code class="sourceCode sql"><span id="cb30-1"><a href="#cb30-1"></a><span class="kw">SELECT</span> movs.<span class="kw">id</span>, </span>
<span id="cb30-2"><a href="#cb30-2"></a>       movs.title,</span>
<span id="cb30-3"><a href="#cb30-3"></a>       <span class="fu">COUNT</span>(<span class="op">*</span>) <span class="kw">AS</span> num_actress</span>
<span id="cb30-4"><a href="#cb30-4"></a><span class="kw">FROM</span> (<span class="kw">SELECT</span> t.<span class="kw">id</span>,</span>
<span id="cb30-5"><a href="#cb30-5"></a>       t.title</span>
<span id="cb30-6"><a href="#cb30-6"></a><span class="kw">FROM</span> title <span class="kw">AS</span> t</span>
<span id="cb30-7"><a href="#cb30-7"></a><span class="kw">JOIN</span> movie_info_idx <span class="kw">AS</span> idx <span class="kw">ON</span> idx.movie_id <span class="op">=</span> t.<span class="kw">id</span></span>
<span id="cb30-8"><a href="#cb30-8"></a><span class="kw">WHERE</span> t.production_year <span class="op">=</span> <span class="dv">2015</span>  </span>
<span id="cb30-9"><a href="#cb30-9"></a>    <span class="kw">AND</span> t.kind_id <span class="op">=</span> <span class="dv">1</span>               # movies <span class="kw">only</span></span>
<span id="cb30-10"><a href="#cb30-10"></a>    <span class="kw">AND</span> idx.info_type_id <span class="op">=</span> <span class="dv">100</span>      # info_type <span class="kw">is</span> votes</span>
<span id="cb30-11"><a href="#cb30-11"></a>    <span class="kw">AND</span> idx.info <span class="op">&gt;</span> <span class="dv">400000</span>) <span class="kw">AS</span> movs  # <span class="kw">at</span> <span class="fu">least</span> <span class="dv">400</span>,<span class="dv">000</span> votes</span>
<span id="cb30-12"><a href="#cb30-12"></a><span class="kw">JOIN</span> (<span class="kw">SELECT</span> a.person_id,</span>
<span id="cb30-13"><a href="#cb30-13"></a>       a.movie_id,</span>
<span id="cb30-14"><a href="#cb30-14"></a>       n.name</span>
<span id="cb30-15"><a href="#cb30-15"></a>    <span class="kw">FROM</span> cast_info <span class="kw">AS</span> a</span>
<span id="cb30-16"><a href="#cb30-16"></a>    <span class="kw">JOIN</span> aka_name <span class="kw">AS</span> n <span class="kw">ON</span> a.person_id <span class="op">=</span> n.person_id</span>
<span id="cb30-17"><a href="#cb30-17"></a>    <span class="kw">WHERE</span> a.role_id <span class="op">=</span> <span class="dv">2</span>             # acresses <span class="kw">only</span></span>
<span id="cb30-18"><a href="#cb30-18"></a>        <span class="kw">AND</span> a.person_id <span class="op">&gt;</span> <span class="dv">3900000</span>) <span class="kw">AS</span> acts <span class="kw">ON</span> acts.movie_id <span class="op">=</span> movs.<span class="kw">id</span></span>
<span id="cb30-19"><a href="#cb30-19"></a><span class="kw">GROUP</span> <span class="kw">BY</span> movs.<span class="kw">id</span>;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="knitsql-table">

<table>
<caption>
6 records
</caption>
<thead>
<tr>
<th style="text-align:right;">
id
</th>
<th style="text-align:left;">
title
</th>
<th style="text-align:right;">
num_actress
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
3313672
</td>
<td style="text-align:left;">
Avengers: Age of Ultron
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:right;">
3752999
</td>
<td style="text-align:left;">
Inside Out
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:right;">
3787790
</td>
<td style="text-align:left;">
Jurassic World
</td>
<td style="text-align:right;">
9
</td>
</tr>
<tr>
<td style="text-align:right;">
3915213
</td>
<td style="text-align:left;">
Mad Max: Fury Road
</td>
<td style="text-align:right;">
5
</td>
</tr>
<tr>
<td style="text-align:right;">
4260166
</td>
<td style="text-align:left;">
Star Wars: Episode VII - The Force Awakens
</td>
<td style="text-align:right;">
15
</td>
</tr>
<tr>
<td style="text-align:right;">
4389619
</td>
<td style="text-align:left;">
The Martian
</td>
<td style="text-align:right;">
1
</td>
</tr>
</tbody>

</table>
</div>
</div>
</section>
<section id="unioning" class="slide level2">
<h2><code>UNION</code>ing</h2>
<p>In <strong>SQL</strong> a <code>UNION</code> clause combines two different tables by their rows (whereas <code>JOIN</code> combines two tables by columns). Think about <code>UNION</code> similarly to the <code>bind_rows()</code> command in <strong>R</strong>.</p>

<img data-src="2024-01-10-joins_files/figure-revealjs/fig-table-union-1.png" style="width:120.0%" alt="Mini data tables describing how UNION binds rows and JOIN appends columns." class="r-stretch quarto-figure-center"><p class="caption">Figure&nbsp;3: UNION binds rows while JOIN appends columns, image credit: Jane Williams https://blog.devart.com/mysql-union-tutorial-html.html</p></section>
<section id="unions" class="slide level2">
<h2><code>UNION</code>s</h2>
<p>Silly example where the column names are ignored.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode numberSource sql number-lines code-with-copy"><code class="sourceCode sql"><span id="cb31-1"><a href="#cb31-1"></a><span class="kw">SELECT</span> </span>
<span id="cb31-2"><a href="#cb31-2"></a>    <span class="dv">1</span> <span class="kw">AS</span> bar,</span>
<span id="cb31-3"><a href="#cb31-3"></a>    <span class="dv">2</span> <span class="kw">AS</span> foo</span>
<span id="cb31-4"><a href="#cb31-4"></a></span>
<span id="cb31-5"><a href="#cb31-5"></a><span class="kw">UNION</span></span>
<span id="cb31-6"><a href="#cb31-6"></a></span>
<span id="cb31-7"><a href="#cb31-7"></a><span class="kw">SELECT</span> </span>
<span id="cb31-8"><a href="#cb31-8"></a>    <span class="dv">10</span> <span class="kw">AS</span> foo,</span>
<span id="cb31-9"><a href="#cb31-9"></a>    <span class="dv">20</span> <span class="kw">AS</span> bar;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="knitsql-table">

<table>
<caption>
2 records
</caption>
<thead>
<tr>
<th style="text-align:right;">
bar
</th>
<th style="text-align:right;">
foo
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
2
</td>
</tr>
<tr>
<td style="text-align:right;">
10
</td>
<td style="text-align:right;">
20
</td>
</tr>
</tbody>

</table>
</div>
</div>
</section>
<section id="union" class="slide level2 scrollable">
<h2><code>UNION</code></h2>
<p><code>UNION</code> is specifically designed to bind rows from two different <code>SELECT</code> queries where the variables have been selected in the same order.</p>
<p>Combine the top voted movies from 2015 with the top voted movies from 2019.</p>
<p>However, to account for time, we require the movies from 2015 to have more votes (400,000) than the movies from 2017 (200,000).</p>
<p>That is, the <code>WHERE</code> clause is different for the two subqueries.</p>
</section>
<section id="union-1" class="slide level2 scrollable">
<h2><code>UNION</code></h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode numberSource sql number-lines code-with-copy"><code class="sourceCode sql"><span id="cb32-1"><a href="#cb32-1"></a>(<span class="kw">SELECT</span> t.title, </span>
<span id="cb32-2"><a href="#cb32-2"></a>        t.production_year, </span>
<span id="cb32-3"><a href="#cb32-3"></a>        idx.info <span class="kw">AS</span> num_votes</span>
<span id="cb32-4"><a href="#cb32-4"></a>    <span class="kw">FROM</span> title <span class="kw">AS</span> t</span>
<span id="cb32-5"><a href="#cb32-5"></a><span class="kw">JOIN</span> movie_info_idx <span class="kw">AS</span> idx <span class="kw">ON</span> idx.movie_id <span class="op">=</span> t.<span class="kw">id</span></span>
<span id="cb32-6"><a href="#cb32-6"></a><span class="kw">WHERE</span> t.production_year <span class="op">=</span> <span class="dv">2015</span>  </span>
<span id="cb32-7"><a href="#cb32-7"></a>    <span class="kw">AND</span> t.kind_id <span class="op">=</span> <span class="dv">1</span>               </span>
<span id="cb32-8"><a href="#cb32-8"></a>    <span class="kw">AND</span> idx.info_type_id <span class="op">=</span> <span class="dv">100</span>      </span>
<span id="cb32-9"><a href="#cb32-9"></a>    <span class="kw">AND</span> idx.info <span class="op">&gt;</span> <span class="dv">400000</span>)</span>
<span id="cb32-10"><a href="#cb32-10"></a></span>
<span id="cb32-11"><a href="#cb32-11"></a><span class="kw">UNION</span></span>
<span id="cb32-12"><a href="#cb32-12"></a></span>
<span id="cb32-13"><a href="#cb32-13"></a>(<span class="kw">SELECT</span> t.title, </span>
<span id="cb32-14"><a href="#cb32-14"></a>        t.production_year, </span>
<span id="cb32-15"><a href="#cb32-15"></a>        idx.info <span class="kw">AS</span> num_votes</span>
<span id="cb32-16"><a href="#cb32-16"></a>    <span class="kw">FROM</span> title <span class="kw">AS</span> t</span>
<span id="cb32-17"><a href="#cb32-17"></a><span class="kw">JOIN</span> movie_info_idx <span class="kw">AS</span> idx <span class="kw">ON</span> idx.movie_id <span class="op">=</span> t.<span class="kw">id</span></span>
<span id="cb32-18"><a href="#cb32-18"></a><span class="kw">WHERE</span> t.production_year <span class="op">=</span> <span class="dv">2017</span>  </span>
<span id="cb32-19"><a href="#cb32-19"></a>    <span class="kw">AND</span> t.kind_id <span class="op">=</span> <span class="dv">1</span>               </span>
<span id="cb32-20"><a href="#cb32-20"></a>    <span class="kw">AND</span> idx.info_type_id <span class="op">=</span> <span class="dv">100</span>      </span>
<span id="cb32-21"><a href="#cb32-21"></a>    <span class="kw">AND</span> idx.info <span class="op">&gt;</span> <span class="dv">200000</span>)</span>
<span id="cb32-22"><a href="#cb32-22"></a><span class="kw">LIMIT</span> <span class="dv">0</span>, <span class="dv">100</span>;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="knitsql-table">

<table>
<caption>
Displaying records 1 - 10
</caption>
<thead>
<tr>
<th style="text-align:left;">
title
</th>
<th style="text-align:right;">
production_year
</th>
<th style="text-align:left;">
num_votes
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Avengers: Age of Ultron
</td>
<td style="text-align:right;">
2015
</td>
<td style="text-align:left;">
540606
</td>
</tr>
<tr>
<td style="text-align:left;">
Inside Out
</td>
<td style="text-align:right;">
2015
</td>
<td style="text-align:left;">
443051
</td>
</tr>
<tr>
<td style="text-align:left;">
Jurassic World
</td>
<td style="text-align:right;">
2015
</td>
<td style="text-align:left;">
471237
</td>
</tr>
<tr>
<td style="text-align:left;">
Mad Max: Fury Road
</td>
<td style="text-align:right;">
2015
</td>
<td style="text-align:left;">
666484
</td>
</tr>
<tr>
<td style="text-align:left;">
Star Wars: Episode VII - The Force Awakens
</td>
<td style="text-align:right;">
2015
</td>
<td style="text-align:left;">
691691
</td>
</tr>
<tr>
<td style="text-align:left;">
The Martian
</td>
<td style="text-align:right;">
2015
</td>
<td style="text-align:left;">
583987
</td>
</tr>
<tr>
<td style="text-align:left;">
The Revenant
</td>
<td style="text-align:right;">
2015
</td>
<td style="text-align:left;">
526189
</td>
</tr>
<tr>
<td style="text-align:left;">
Dunkirk
</td>
<td style="text-align:right;">
2017
</td>
<td style="text-align:left;">
229089
</td>
</tr>
<tr>
<td style="text-align:left;">
Guardians of the Galaxy Vol. 2
</td>
<td style="text-align:right;">
2017
</td>
<td style="text-align:left;">
281845
</td>
</tr>
<tr>
<td style="text-align:left;">
Logan
</td>
<td style="text-align:right;">
2017
</td>
<td style="text-align:left;">
397056
</td>
</tr>
</tbody>

</table>
</div>
</div>
</section>
<section id="union-all" class="slide level2 scrollable">
<h2><code>UNION ALL</code></h2>
<p>If the goal is to include duplicates across two tables, use <code>UNION ALL</code> instead of <code>UNION</code>.</p>
<p>Let’s say that the first table is all movies with production year after 2012 and number of votes greater than 500,000. The second table is movies with production year equal to 2015 and number of votes greater than 400,000.</p>
<p>The Martian would be in both tables.</p>
</section>
<section id="union-all-1" class="slide level2 scrollable">
<h2><code>UNION ALL</code></h2>
<p>With just <code>UNION</code></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode numberSource sql number-lines code-with-copy"><code class="sourceCode sql"><span id="cb33-1"><a href="#cb33-1"></a>(<span class="kw">SELECT</span> t.title,</span>
<span id="cb33-2"><a href="#cb33-2"></a>        t.production_year, </span>
<span id="cb33-3"><a href="#cb33-3"></a>        idx.info <span class="kw">AS</span> num_votes</span>
<span id="cb33-4"><a href="#cb33-4"></a>    <span class="kw">FROM</span> title <span class="kw">AS</span> t</span>
<span id="cb33-5"><a href="#cb33-5"></a><span class="kw">JOIN</span> movie_info_idx <span class="kw">AS</span> idx <span class="kw">ON</span> idx.movie_id <span class="op">=</span> t.<span class="kw">id</span></span>
<span id="cb33-6"><a href="#cb33-6"></a><span class="kw">WHERE</span> t.production_year <span class="op">&gt;</span> <span class="dv">2012</span>  </span>
<span id="cb33-7"><a href="#cb33-7"></a>    <span class="kw">AND</span> t.kind_id <span class="op">=</span> <span class="dv">1</span>               </span>
<span id="cb33-8"><a href="#cb33-8"></a>    <span class="kw">AND</span> idx.info_type_id <span class="op">=</span> <span class="dv">100</span>      </span>
<span id="cb33-9"><a href="#cb33-9"></a>    <span class="kw">AND</span> idx.info <span class="op">&gt;</span> <span class="dv">500000</span>)</span>
<span id="cb33-10"><a href="#cb33-10"></a></span>
<span id="cb33-11"><a href="#cb33-11"></a><span class="kw">UNION</span></span>
<span id="cb33-12"><a href="#cb33-12"></a></span>
<span id="cb33-13"><a href="#cb33-13"></a>(<span class="kw">SELECT</span> t.title, </span>
<span id="cb33-14"><a href="#cb33-14"></a>        t.production_year, </span>
<span id="cb33-15"><a href="#cb33-15"></a>        idx.info <span class="kw">AS</span> num_votes</span>
<span id="cb33-16"><a href="#cb33-16"></a>    <span class="kw">FROM</span> title <span class="kw">AS</span> t</span>
<span id="cb33-17"><a href="#cb33-17"></a><span class="kw">JOIN</span> movie_info_idx <span class="kw">AS</span> idx <span class="kw">ON</span> idx.movie_id <span class="op">=</span> t.<span class="kw">id</span></span>
<span id="cb33-18"><a href="#cb33-18"></a><span class="kw">WHERE</span> t.production_year <span class="op">=</span> <span class="dv">2015</span>  </span>
<span id="cb33-19"><a href="#cb33-19"></a>    <span class="kw">AND</span> t.kind_id <span class="op">=</span> <span class="dv">1</span>               </span>
<span id="cb33-20"><a href="#cb33-20"></a>    <span class="kw">AND</span> idx.info_type_id <span class="op">=</span> <span class="dv">100</span>      </span>
<span id="cb33-21"><a href="#cb33-21"></a>    <span class="kw">AND</span> idx.info <span class="op">&gt;</span> <span class="dv">400000</span>)</span>
<span id="cb33-22"><a href="#cb33-22"></a><span class="kw">ORDER</span> <span class="kw">BY</span> production_year <span class="kw">DESC</span>, num_votes;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="knitsql-table">

<table>
<caption>
Displaying records 1 - 10
</caption>
<thead>
<tr>
<th style="text-align:left;">
title
</th>
<th style="text-align:right;">
production_year
</th>
<th style="text-align:left;">
num_votes
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Batman v Superman: Dawn of Justice
</td>
<td style="text-align:right;">
2016
</td>
<td style="text-align:left;">
500037
</td>
</tr>
<tr>
<td style="text-align:left;">
Deadpool
</td>
<td style="text-align:right;">
2016
</td>
<td style="text-align:left;">
673887
</td>
</tr>
<tr>
<td style="text-align:left;">
Inside Out
</td>
<td style="text-align:right;">
2015
</td>
<td style="text-align:left;">
443051
</td>
</tr>
<tr>
<td style="text-align:left;">
Jurassic World
</td>
<td style="text-align:right;">
2015
</td>
<td style="text-align:left;">
471237
</td>
</tr>
<tr>
<td style="text-align:left;">
The Revenant
</td>
<td style="text-align:right;">
2015
</td>
<td style="text-align:left;">
526189
</td>
</tr>
<tr>
<td style="text-align:left;">
Avengers: Age of Ultron
</td>
<td style="text-align:right;">
2015
</td>
<td style="text-align:left;">
540606
</td>
</tr>
<tr>
<td style="text-align:left;">
The Martian
</td>
<td style="text-align:right;">
2015
</td>
<td style="text-align:left;">
583987
</td>
</tr>
<tr>
<td style="text-align:left;">
Mad Max: Fury Road
</td>
<td style="text-align:right;">
2015
</td>
<td style="text-align:left;">
666484
</td>
</tr>
<tr>
<td style="text-align:left;">
Star Wars: Episode VII - The Force Awakens
</td>
<td style="text-align:right;">
2015
</td>
<td style="text-align:left;">
691691
</td>
</tr>
<tr>
<td style="text-align:left;">
Interstellar
</td>
<td style="text-align:right;">
2014
</td>
<td style="text-align:left;">
1102826
</td>
</tr>
</tbody>

</table>
</div>
</div>
</section>
<section id="union-all-2" class="slide level2 scrollable">
<h2><code>UNION ALL</code></h2>
<p>When <code>UNION ALL</code> is applied, The Martian is listed twice in the results table.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode numberSource sql number-lines code-with-copy"><code class="sourceCode sql"><span id="cb34-1"><a href="#cb34-1"></a>(<span class="kw">SELECT</span> t.title,</span>
<span id="cb34-2"><a href="#cb34-2"></a>        t.production_year, </span>
<span id="cb34-3"><a href="#cb34-3"></a>        idx.info <span class="kw">AS</span> num_votes</span>
<span id="cb34-4"><a href="#cb34-4"></a>    <span class="kw">FROM</span> title <span class="kw">AS</span> t</span>
<span id="cb34-5"><a href="#cb34-5"></a><span class="kw">JOIN</span> movie_info_idx <span class="kw">AS</span> idx <span class="kw">ON</span> idx.movie_id <span class="op">=</span> t.<span class="kw">id</span></span>
<span id="cb34-6"><a href="#cb34-6"></a><span class="kw">WHERE</span> t.production_year <span class="op">&gt;</span> <span class="dv">2012</span>  </span>
<span id="cb34-7"><a href="#cb34-7"></a>    <span class="kw">AND</span> t.kind_id <span class="op">=</span> <span class="dv">1</span>               </span>
<span id="cb34-8"><a href="#cb34-8"></a>    <span class="kw">AND</span> idx.info_type_id <span class="op">=</span> <span class="dv">100</span>      </span>
<span id="cb34-9"><a href="#cb34-9"></a>    <span class="kw">AND</span> idx.info <span class="op">&gt;</span> <span class="dv">500000</span>)</span>
<span id="cb34-10"><a href="#cb34-10"></a></span>
<span id="cb34-11"><a href="#cb34-11"></a><span class="kw">UNION</span> <span class="kw">ALL</span></span>
<span id="cb34-12"><a href="#cb34-12"></a></span>
<span id="cb34-13"><a href="#cb34-13"></a>(<span class="kw">SELECT</span> t.title, </span>
<span id="cb34-14"><a href="#cb34-14"></a>        t.production_year, </span>
<span id="cb34-15"><a href="#cb34-15"></a>        idx.info <span class="kw">AS</span> num_votes</span>
<span id="cb34-16"><a href="#cb34-16"></a>    <span class="kw">FROM</span> title <span class="kw">AS</span> t</span>
<span id="cb34-17"><a href="#cb34-17"></a><span class="kw">JOIN</span> movie_info_idx <span class="kw">AS</span> idx <span class="kw">ON</span> idx.movie_id <span class="op">=</span> t.<span class="kw">id</span></span>
<span id="cb34-18"><a href="#cb34-18"></a><span class="kw">WHERE</span> t.production_year <span class="op">=</span> <span class="dv">2015</span>  </span>
<span id="cb34-19"><a href="#cb34-19"></a>    <span class="kw">AND</span> t.kind_id <span class="op">=</span> <span class="dv">1</span>               </span>
<span id="cb34-20"><a href="#cb34-20"></a>    <span class="kw">AND</span> idx.info_type_id <span class="op">=</span> <span class="dv">100</span>      </span>
<span id="cb34-21"><a href="#cb34-21"></a>    <span class="kw">AND</span> idx.info <span class="op">&gt;</span> <span class="dv">400000</span>)</span>
<span id="cb34-22"><a href="#cb34-22"></a><span class="kw">ORDER</span> <span class="kw">BY</span> production_year <span class="kw">DESC</span>, num_votes;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="knitsql-table">

<table>
<caption>
Displaying records 1 - 10
</caption>
<thead>
<tr>
<th style="text-align:left;">
title
</th>
<th style="text-align:right;">
production_year
</th>
<th style="text-align:left;">
num_votes
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Batman v Superman: Dawn of Justice
</td>
<td style="text-align:right;">
2016
</td>
<td style="text-align:left;">
500037
</td>
</tr>
<tr>
<td style="text-align:left;">
Deadpool
</td>
<td style="text-align:right;">
2016
</td>
<td style="text-align:left;">
673887
</td>
</tr>
<tr>
<td style="text-align:left;">
Inside Out
</td>
<td style="text-align:right;">
2015
</td>
<td style="text-align:left;">
443051
</td>
</tr>
<tr>
<td style="text-align:left;">
Jurassic World
</td>
<td style="text-align:right;">
2015
</td>
<td style="text-align:left;">
471237
</td>
</tr>
<tr>
<td style="text-align:left;">
The Revenant
</td>
<td style="text-align:right;">
2015
</td>
<td style="text-align:left;">
526189
</td>
</tr>
<tr>
<td style="text-align:left;">
The Revenant
</td>
<td style="text-align:right;">
2015
</td>
<td style="text-align:left;">
526189
</td>
</tr>
<tr>
<td style="text-align:left;">
Avengers: Age of Ultron
</td>
<td style="text-align:right;">
2015
</td>
<td style="text-align:left;">
540606
</td>
</tr>
<tr>
<td style="text-align:left;">
Avengers: Age of Ultron
</td>
<td style="text-align:right;">
2015
</td>
<td style="text-align:left;">
540606
</td>
</tr>
<tr>
<td style="text-align:left;">
The Martian
</td>
<td style="text-align:right;">
2015
</td>
<td style="text-align:left;">
583987
</td>
</tr>
<tr>
<td style="text-align:left;">
The Martian
</td>
<td style="text-align:right;">
2015
</td>
<td style="text-align:left;">
583987
</td>
</tr>
</tbody>

</table>
</div>
</div>
</section>
<section id="best-practice" class="slide level2">
<h2>Best practice</h2>
<p>It is always a good idea to terminate the <strong>SQL</strong> connection when you are done with it.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1"></a>DBI<span class="sc">::</span><span class="fu">dbDisconnect</span>(con_imdb, <span class="at">shutdown =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>

<div class="footer footer-default">

</div>
</section></section>
    </div>
  </div>

  <script>window.backupDefine = window.define; window.define = undefined;</script>
  <script src="../site_libs/revealjs/dist/reveal.js"></script>
  <!-- reveal.js plugins -->
  <script src="../site_libs/revealjs/plugin/quarto-line-highlight/line-highlight.js"></script>
  <script src="../site_libs/revealjs/plugin/pdf-export/pdfexport.js"></script>
  <script src="../site_libs/revealjs/plugin/reveal-menu/menu.js"></script>
  <script src="../site_libs/revealjs/plugin/reveal-menu/quarto-menu.js"></script>
  <script src="../site_libs/revealjs/plugin/quarto-support/support.js"></script>
  

  <script src="../site_libs/revealjs/plugin/notes/notes.js"></script>
  <script src="../site_libs/revealjs/plugin/search/search.js"></script>
  <script src="../site_libs/revealjs/plugin/zoom/zoom.js"></script>
  <script src="../site_libs/revealjs/plugin/math/math.js"></script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script>

  <script>

      // Full list of configuration options available at:
      // https://revealjs.com/config/
      Reveal.initialize({
'controlsAuto': true,
'previewLinksAuto': false,
'smaller': false,
'pdfSeparateFragments': false,
'autoAnimateEasing': "ease",
'autoAnimateDuration': 1,
'autoAnimateUnmatched': true,
'menu': {"side":"left","useTextContentForMissingTitles":true,"markers":false,"loadIcons":false,"custom":[{"title":"Tools","icon":"<i class=\"fas fa-gear\"></i>","content":"<ul class=\"slide-menu-items\">\n<li class=\"slide-tool-item active\" data-item=\"0\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.fullscreen(event)\"><kbd>f</kbd> Fullscreen</a></li>\n<li class=\"slide-tool-item\" data-item=\"1\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.speakerMode(event)\"><kbd>s</kbd> Speaker View</a></li>\n<li class=\"slide-tool-item\" data-item=\"2\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>o</kbd> Slide Overview</a></li>\n<li class=\"slide-tool-item\" data-item=\"3\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.togglePdfExport(event)\"><kbd>e</kbd> PDF Export Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"4\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.keyboardHelp(event)\"><kbd>?</kbd> Keyboard Help</a></li>\n</ul>"}],"openButton":true},
'smaller': false,
 
        // Display controls in the bottom right corner
        controls: false,

        // Help the user learn the controls by providing hints, for example by
        // bouncing the down arrow when they first encounter a vertical slide
        controlsTutorial: false,

        // Determines where controls appear, "edges" or "bottom-right"
        controlsLayout: 'edges',

        // Visibility rule for backwards navigation arrows; "faded", "hidden"
        // or "visible"
        controlsBackArrows: 'faded',

        // Display a presentation progress bar
        progress: true,

        // Display the page number of the current slide
        slideNumber: 'c/t',

        // 'all', 'print', or 'speaker'
        showSlideNumber: 'all',

        // Add the current slide number to the URL hash so that reloading the
        // page/copying the URL will return you to the same slide
        hash: true,

        // Start with 1 for the hash rather than 0
        hashOneBasedIndex: false,

        // Flags if we should monitor the hash and change slides accordingly
        respondToHashChanges: true,

        // Push each slide change to the browser history
        history: true,

        // Enable keyboard shortcuts for navigation
        keyboard: true,

        // Enable the slide overview mode
        overview: true,

        // Disables the default reveal.js slide layout (scaling and centering)
        // so that you can use custom CSS layout
        disableLayout: false,

        // Vertical centering of slides
        center: false,

        // Enables touch navigation on devices with touch input
        touch: true,

        // Loop the presentation
        loop: false,

        // Change the presentation direction to be RTL
        rtl: false,

        // see https://revealjs.com/vertical-slides/#navigation-mode
        navigationMode: 'linear',

        // Randomizes the order of slides each time the presentation loads
        shuffle: false,

        // Turns fragments on and off globally
        fragments: true,

        // Flags whether to include the current fragment in the URL,
        // so that reloading brings you to the same fragment position
        fragmentInURL: false,

        // Flags if the presentation is running in an embedded mode,
        // i.e. contained within a limited portion of the screen
        embedded: false,

        // Flags if we should show a help overlay when the questionmark
        // key is pressed
        help: true,

        // Flags if it should be possible to pause the presentation (blackout)
        pause: true,

        // Flags if speaker notes should be visible to all viewers
        showNotes: false,

        // Global override for autoplaying embedded media (null/true/false)
        autoPlayMedia: null,

        // Global override for preloading lazy-loaded iframes (null/true/false)
        preloadIframes: null,

        // Number of milliseconds between automatically proceeding to the
        // next slide, disabled when set to 0, this value can be overwritten
        // by using a data-autoslide attribute on your slides
        autoSlide: 0,

        // Stop auto-sliding after user input
        autoSlideStoppable: true,

        // Use this method for navigation when auto-sliding
        autoSlideMethod: null,

        // Specify the average time in seconds that you think you will spend
        // presenting each slide. This is used to show a pacing timer in the
        // speaker view
        defaultTiming: null,

        // Enable slide navigation via mouse wheel
        mouseWheel: false,

        // The display mode that will be used to show slides
        display: 'block',

        // Hide cursor if inactive
        hideInactiveCursor: true,

        // Time before the cursor is hidden (in ms)
        hideCursorTime: 5000,

        // Opens links in an iframe preview overlay
        previewLinks: false,

        // Transition style (none/fade/slide/convex/concave/zoom)
        transition: 'none',

        // Transition speed (default/fast/slow)
        transitionSpeed: 'default',

        // Transition style for full page slide backgrounds
        // (none/fade/slide/convex/concave/zoom)
        backgroundTransition: 'none',

        // Number of slides away from the current that are visible
        viewDistance: 3,

        // Number of slides away from the current that are visible on mobile
        // devices. It is advisable to set this to a lower number than
        // viewDistance in order to save resources.
        mobileViewDistance: 2,

        // The "normal" size of the presentation, aspect ratio will be preserved
        // when the presentation is scaled to fit different resolutions. Can be
        // specified using percentage units.
        width: 1050,

        height: 700,

        // Factor of the display size that should remain empty around the content
        margin: 0.1,

        math: {
          mathjax: 'https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js',
          config: 'TeX-AMS_HTML-full',
          tex2jax: {
            inlineMath: [['\\(','\\)']],
            displayMath: [['\\[','\\]']],
            balanceBraces: true,
            processEscapes: false,
            processRefs: true,
            processEnvironments: true,
            preview: 'TeX',
            skipTags: ['script','noscript','style','textarea','pre','code'],
            ignoreClass: 'tex2jax_ignore',
            processClass: 'tex2jax_process'
          },
        },

        // reveal.js plugins
        plugins: [QuartoLineHighlight, PdfExport, RevealMenu, QuartoSupport,

          RevealMath,
          RevealNotes,
          RevealSearch,
          RevealZoom
        ]
      });
    </script>
    
    <script>
      // htmlwidgets need to know to resize themselves when slides are shown/hidden.
      // Fire the "slideenter" event (handled by htmlwidgets.js) when the current
      // slide changes (different for each slide format).
      (function () {
        // dispatch for htmlwidgets
        function fireSlideEnter() {
          const event = window.document.createEvent("Event");
          event.initEvent("slideenter", true, true);
          window.document.dispatchEvent(event);
        }

        function fireSlideChanged(previousSlide, currentSlide) {
          fireSlideEnter();

          // dispatch for shiny
          if (window.jQuery) {
            if (previousSlide) {
              window.jQuery(previousSlide).trigger("hidden");
            }
            if (currentSlide) {
              window.jQuery(currentSlide).trigger("shown");
            }
          }
        }

        // hookup for slidy
        if (window.w3c_slidy) {
          window.w3c_slidy.add_observer(function (slide_num) {
            // slide_num starts at position 1
            fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);
          });
        }

      })();
    </script>

    <script id="quarto-html-after-body" type="application/javascript">
    window.document.addEventListener("DOMContentLoaded", function (event) {
      const toggleBodyColorMode = (bsSheetEl) => {
        const mode = bsSheetEl.getAttribute("data-mode");
        const bodyEl = window.document.querySelector("body");
        if (mode === "dark") {
          bodyEl.classList.add("quarto-dark");
          bodyEl.classList.remove("quarto-light");
        } else {
          bodyEl.classList.add("quarto-light");
          bodyEl.classList.remove("quarto-dark");
        }
      }
      const toggleBodyColorPrimary = () => {
        const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
        if (bsSheetEl) {
          toggleBodyColorMode(bsSheetEl);
        }
      }
      toggleBodyColorPrimary();  
      const tabsets =  window.document.querySelectorAll(".panel-tabset-tabby")
      tabsets.forEach(function(tabset) {
        const tabby = new Tabby('#' + tabset.id);
      });
      const isCodeAnnotation = (el) => {
        for (const clz of el.classList) {
          if (clz.startsWith('code-annotation-')) {                     
            return true;
          }
        }
        return false;
      }
      const clipboard = new window.ClipboardJS('.code-copy-button', {
        text: function(trigger) {
          const codeEl = trigger.previousElementSibling.cloneNode(true);
          for (const childEl of codeEl.children) {
            if (isCodeAnnotation(childEl)) {
              childEl.remove();
            }
          }
          return codeEl.innerText;
        }
      });
      clipboard.on('success', function(e) {
        // button target
        const button = e.trigger;
        // don't keep focus
        button.blur();
        // flash "checked"
        button.classList.add('code-copy-button-checked');
        var currentTitle = button.getAttribute("title");
        button.setAttribute("title", "Copied!");
        let tooltip;
        if (window.bootstrap) {
          button.setAttribute("data-bs-toggle", "tooltip");
          button.setAttribute("data-bs-placement", "left");
          button.setAttribute("data-bs-title", "Copied!");
          tooltip = new bootstrap.Tooltip(button, 
            { trigger: "manual", 
              customClass: "code-copy-button-tooltip",
              offset: [0, -8]});
          tooltip.show();    
        }
        setTimeout(function() {
          if (tooltip) {
            tooltip.hide();
            button.removeAttribute("data-bs-title");
            button.removeAttribute("data-bs-toggle");
            button.removeAttribute("data-bs-placement");
          }
          button.setAttribute("title", currentTitle);
          button.classList.remove('code-copy-button-checked');
        }, 1000);
        // clear code selection
        e.clearSelection();
      });
      function tippyHover(el, contentFn) {
        const config = {
          allowHTML: true,
          content: contentFn,
          maxWidth: 500,
          delay: 100,
          arrow: false,
          appendTo: function(el) {
              return el.closest('section.slide') || el.parentElement;
          },
          interactive: true,
          interactiveBorder: 10,
          theme: 'light-border',
          placement: 'bottom-start'
        };
          config['offset'] = [0,0];
          config['maxWidth'] = 700;
        window.tippy(el, config); 
      }
      const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
      for (var i=0; i<noterefs.length; i++) {
        const ref = noterefs[i];
        tippyHover(ref, function() {
          // use id or data attribute instead here
          let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
          try { href = new URL(href).hash; } catch {}
          const id = href.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          return note.innerHTML;
        });
      }
      const findCites = (el) => {
        const parentEl = el.parentElement;
        if (parentEl) {
          const cites = parentEl.dataset.cites;
          if (cites) {
            return {
              el,
              cites: cites.split(' ')
            };
          } else {
            return findCites(el.parentElement)
          }
        } else {
          return undefined;
        }
      };
      var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
      for (var i=0; i<bibliorefs.length; i++) {
        const ref = bibliorefs[i];
        const citeInfo = findCites(ref);
        if (citeInfo) {
          tippyHover(citeInfo.el, function() {
            var popup = window.document.createElement('div');
            citeInfo.cites.forEach(function(cite) {
              var citeDiv = window.document.createElement('div');
              citeDiv.classList.add('hanging-indent');
              citeDiv.classList.add('csl-entry');
              var biblioDiv = window.document.getElementById('ref-' + cite);
              if (biblioDiv) {
                citeDiv.innerHTML = biblioDiv.innerHTML;
              }
              popup.appendChild(citeDiv);
            });
            return popup.innerHTML;
          });
        }
      }
    });
    </script>
    

</body></html>